(this.webpackJsonpcarbon_copy=this.webpackJsonpcarbon_copy||[]).push([[0],{134:function(e,t,n){e.exports=n.p+"static/media/logo512.e400cec2.png"},2105:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),c=n.n(o);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(352);var i,l,s,u,p,m=n(4),d=n(295),f=n.n(d),b=n(181),g=n(2159),v=n(114),h=n(328),O=n(2158),y=n(139),j=n(2108),k=n(7),C=n.n(k),E=n(10),w=Object(a.createContext)(),x=function(){var e=Object(a.useContext)(w);if(!e)throw new Error("useWebcam must be used within a WebcamProvider");return e},S=!!(null===(i=navigator)||void 0===i||null===(l=i.mediaDevices)||void 0===l?void 0:l.getUserMedia),I=function(e){var t,n,o,c,i=e.children,l=Object(a.useRef)(),s=Object(a.useRef)(),u=Object(a.useRef)(),p=Object(a.useState)(null),d=Object(m.a)(p,2),f=d[0],b=d[1],g=Object(a.useState)(!0),v=Object(m.a)(g,2),h=v[0],O=v[1],y=Object(a.useState)(!1),j=Object(m.a)(y,2),k=j[0],x=j[1],I=Object(a.useState)([]),R=Object(m.a)(I,2),T=R[0],M=R[1],N=Object(a.useState)(!0),P=Object(m.a)(N,2),L=P[0],A=P[1],D=Object(a.useState)(null),F=Object(m.a)(D,2),U=F[0],_=F[1],B=Object(a.useState)(null),z=Object(m.a)(B,2),Y=z[0],G=z[1],W=Object(a.useState)(null),V=Object(m.a)(W,2),J=V[0],q=V[1],H=Object(a.useState)(!1),X=Object(m.a)(H,2),K=X[0],$=X[1],Z=Object(a.useState)(!1),Q=Object(m.a)(Z,2),ee=Q[0],te=Q[1],ne=Object(a.useState)(void 0),ae=Object(m.a)(ne,2),re=ae[0],oe=ae[1],ce=Object(a.useState)(void 0),ie=Object(m.a)(ce,2),le=ie[0],se=ie[1];Object(a.useEffect)((function(){u.current&&!f?b(u.current.getContext("2d")):f&&!u.current&&b(null)}),[f]),Object(a.useEffect)((function(){if(k&&!U){var e=document.createElement("canvas");e.width=u.current.width,e.height=u.current.height;var t=e.getContext("2d");_({ctx:t,canvas:e})}}),[U,k]);var ue=Object(a.useCallback)((function(){A(!1)}),[]),pe=Object(a.useCallback)((function(){A(!0)}),[]),me=Object(a.useCallback)((function(){U.ctx.clearRect(0,0,u.current.width,u.current.height)}),[U]),de=Object(a.useCallback)((function(){var e,t;f.clearRect(0,0,null===(e=u.current)||void 0===e?void 0:e.width,null===(t=u.current)||void 0===t?void 0:t.height)}),[f]),fe=Object(a.useCallback)((function(){J&&J.getTracks().forEach((function(e){return e.stop()})),G(null),q(null),x(!1),oe(void 0)}),[J]),be=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,a,r,o,c,i,l,u,p,m,d,f,b;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fe(),S){e.next=6;break}return"Video not supported",console.error("Video not supported"),G("Video not supported"),e.abrupt("return");case 6:return a=(n="number"===typeof t)?{}:t||{},r=n?t:a.deviceIdx,e.prev=9,console.log("Finding Webcams..."),i={video:{width:{exact:a.width||1280},height:{exact:a.height||720}},audio:!1},void 0!==r&&(a.deviceId=null===(l=T[r])||void 0===l?void 0:l.deviceId),a.deviceId&&(i.video.deviceId={exact:a.deviceId}),e.next=16,navigator.mediaDevices.getUserMedia(i);case 16:u=e.sent,p=null===(o=u.getTracks()[0])||void 0===o||null===(c=o.getCapabilities())||void 0===c?void 0:c.deviceId,console.log("Found webcam!"),q(u),oe(p),G(!1),te(!1),$(!1),s.current.srcObject=u,e.next=37;break;case 27:return e.prev=27,e.t0=e.catch(9),"Error starting video.",console.error("Error starting video."),console.error(e.t0.message),(null===(m=e.t0.message)||void 0===m||null===(d=m.toLowerCase)||void 0===d||null===(f=d.call(m))||void 0===f||null===(b=f.includes)||void 0===b?void 0:b.call(f,"permission denied"))&&te(!0),q(null),x(!1),G("Error starting video."),e.abrupt("return");case 37:return e.next=39,Promise.all([new Promise((function(e){s.current.onloadedmetadata=function(){return e()}})),new Promise((function(e){s.current.onloadeddata=function(){return e()}}))]).then((function(){console.log("Webcam ready!"),x(!0),A(!1)}));case 39:return e.abrupt("return",e.sent);case 40:case"end":return e.stop()}}),e,null,[[9,27]])})));return function(t){return e.apply(this,arguments)}}(),[fe,s,T]),ge=Object(a.useCallback)(Object(E.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be({deviceId:le}));case 1:case"end":return e.stop()}}),e)}))),[le,be]),ve=Object(a.useCallback)(Object(E.a)(C.a.mark((function e(){var t,n,a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=navigator)||void 0===t||null===(n=t.mediaDevices)||void 0===n?void 0:n.enumerateDevices){e.next=4;break}return console.error("Cannot get cameras."),e.abrupt("return",[]);case 4:return e.next=6,navigator.mediaDevices.enumerateDevices();case 6:return a=e.sent,r=a.filter((function(e){var t=e.kind,n=e.label;return"videoinput"===t&&!n.includes("CamTwist")})).map((function(e){var t,n=e.label.lastIndexOf(" (");return n>-1&&(t=e.label.slice(0,n)),t?{deviceId:e.deviceId,label:t}:e})),M(r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)}))),[]),he=Object(a.useCallback)((function(){return O((function(e){return!e}))}),[]),Oe=Object(a.useCallback)((function(e){window.localStorage.setItem("AutoStartId",e),se(e)}),[]),ye=Object(a.useCallback)((function(){window.localStorage.removeItem("AutoStartId"),se(null)}),[]),je=Object(a.useCallback)((function(e){me(),U.ctx.putImageData(e,0,0);var t=U.canvas.toDataURL("image/png");return me(),t}),[U,me]),ke=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return me(),(n=new Image).src=t,e.next=5,new Promise((function(e){n.onload=function(){U.ctx.drawImage(n,0,0),e()}}));case 5:return a=U.ctx.getImageData(0,0,u.current.width,u.current.height),me(),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[me,U]),Ce=Object(a.useCallback)((function(){me(),U.ctx.drawImage(s.current,0,0);var e=U.ctx.getImageData(0,0,u.current.width,u.current.height);return me(),e}),[me,U]);Object(a.useEffect)((function(){ve().then((function(e){var t,n=window.localStorage.getItem("AutoStartId"),a=!1,r=null===(t=e[0])||void 0===t?void 0:t.deviceId;(r=e.reduce((function(e,t,r){var o=t.deviceId,c=t.label;return o||(a=!0),o===n?o:e||(c.includes("Built-in")?o:null)}),null)||r)?Oe(r):a?($(!0),console.warn("Need video permissions!")):!r&&n&&ye()}))}),[]);var Ee=!!((null===(t=l.current)||void 0===t?void 0:t.requestFullscreen)||(null===(n=l.current)||void 0===n?void 0:n.mozRequestFullScreen)||(null===(o=l.current)||void 0===o?void 0:o.webkitRequestFullscreen)||(null===(c=l.current)||void 0===c?void 0:c.msRequestFullscreen)),we=Object(a.useState)(!1),xe=Object(m.a)(we,2),Se=xe[0],Ie=xe[1];Object(a.useEffect)((function(){var e=function(){var e=!!document.fullscreenElement;Ie(e)};return document.addEventListener("fullscreenchange",e),function(){return document.removeEventListener("fullscreenchange",e)}}),[]);var Re=Object(a.useCallback)((function(){Ee&&(l.current.requestFullscreen?l.current.requestFullscreen():l.current.mozRequestFullScreen?l.current.mozRequestFullScreen():l.current.webkitRequestFullscreen?l.current.webkitRequestFullscreen():l.current.msRequestFullscreen&&l.current.msRequestFullscreen())}),[Ee]),Te=Object(a.useCallback)((function(){Ee&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),[Ee]),Me=Object(a.useCallback)((function(){Se?Te():Re()}),[Se,Re,Te]),Ne=Object(a.useMemo)((function(){return{ctx:f,ready:k,flipX:h,start:ge,hidden:L,rootRef:l,cameras:T,setFlipX:O,videoRef:s,hasVideo:S,_setHidden:pe,canvasRef:u,stopVideo:fe,setVisible:ue,startVideo:be,videoError:Y,scratchpad:U,clearCanvas:de,toggleFlipX:he,videoStream:J,hasFullScreen:Ee,exitFullScreen:Te,clearScratchpad:me,currentDeviceId:re,enterFullScreen:Re,stop:fe,discoverCameras:ve,permissionNeeded:K,permissionDenied:ee,toggleFullScreen:Me,autoStartDeviceId:le,imageDataToDataUri:je,dataUriToImageData:ke,getVideoAsImageData:Ce,setAutoStartDeviceId:Oe,clearAutoStartDeviceId:ye,isFullScreen:Se}}),[f,k,h,ge,L,T,O,pe,fe,Se,ue,be,Y,U,he,de,J,Ee,Te,me,re,Re,ve,K,ee,Me,le,je,ke,Ce,Oe,ye]);return r.a.createElement(w.Provider,{value:Ne},i)},R=n(52),T=n(6),M=n(33),N=n(2106),P=n(19),L=n(306),A=n.n(L),D=n(305),F=n.n(D),U=n(134),_=n.n(U),B=function(e){var t=e.color,n=void 0===t?"#fff":t,a=Object(P.c)({to:{opacity:1},from:{opacity:0},config:P.b.stiff});return r.a.createElement(P.a.div,{style:a},r.a.createElement("svg",{version:"1.1",id:"L7",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 100 100"},r.a.createElement("path",{fill:n,d:"M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"-360 50 50",repeatCount:"indefinite"})),r.a.createElement("path",{fill:n,d:"M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"},r.a.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"2s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"}))))},z=n(329),Y=n(2164),G=n(2166),W=n(2162),V=n(2150),J=n(299),q=n.n(J),H=n(26),X=n.n(H),K=n(2147),$=Object(j.a)((function(e){return{btn:{border:"2px solid ".concat(e.palette.secondary.main),background:e.palette.primary.main,color:e.palette.secondary.main,transition:"300ms all","&:hover":{border:"2px solid ".concat(e.palette.primary.main),background:e.palette.secondary.main,color:e.palette.primary.main}}}})),Z=function(e){var t=e.Icon,n=e.className,a=Object(R.a)(e,["Icon","className"]),o=$();return r.a.createElement(K.a,Object.assign({size:"small",className:X()(o.btn,Object(T.a)({},n,n))},a),r.a.createElement(t,null))},Q=function(){},ee=Object(j.a)((function(e){return{root:function(e){return{position:"relative"}},arrowIcon:function(t){return{marginLeft:e.spacing(1)}},tooltip:function(e){return{position:"relative",margin:0}},arrow:function(e){return{position:"absolute",fontSize:6,"&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}}},paper:{border:"1px solid #d3d4d5"},popper:function(t){return{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"0 1em 1em 1em",borderColor:"transparent transparent ".concat(e.palette.grey[700]," transparent")}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.95em",width:"2em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:"".concat(e.palette.grey[700]," transparent transparent transparent")}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 1em 1em 0",borderColor:"transparent ".concat(e.palette.grey[700]," transparent transparent")}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.95em",height:"2em",width:"1em","&::before":{borderWidth:"1em 0 1em 1em",borderColor:"transparent transparent transparent ".concat(e.palette.grey[700])}}}}}})),te=function(e){var t,n=ee(e),o=Object(a.useMemo)(Math.random,[]),c=Object(a.useRef)(),i=Object(a.useState)(null),l=Object(m.a)(i,2),s=l[0],u=l[1],p=Object(a.useState)(null),d=Object(m.a)(p,2),f=d[0],b=d[1];Object(a.useEffect)((function(){return c.current=!0,function(){c.current=!1}}),[]);var g=Object(a.useCallback)((function(e){c.current&&u(e.currentTarget)}),[]),v=Object(a.useCallback)((function(){c.current&&u(null)}),[]),h=Object(a.useCallback)(Object(E.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e.onClose||Q)();case 2:!0!==t.sent&&v();case 4:case"end":return t.stop()}}),t)}))),[v,e.onClose]),O=Object(a.useCallback)((function(t){(e.onClickCheckbox||Q)(t.target.value,h)}),[e.onClickCheckbox,h]),y=Object(a.useCallback)((function(t){return function(){var n=Object(E.a)(C.a.mark((function n(a){return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("checkbox"!==a.target.type){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(e.onSelect||Q)(t);case 4:!0!==n.sent&&h();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),[h,e.onSelect]),j=!!s;return r.a.createElement("div",{className:n.root},r.a.createElement(Z,Object.assign({"aria-haspopup":"true",className:n.button,onClick:g,"aria-controls":"select-and-check-".concat(o),Icon:q.a},e.SelectProps)),r.a.createElement(z.a,Object.assign({keepMounted:!0,open:j,elevation:0,anchorEl:s,getContentAnchorEl:null,onClose:h,id:"select-and-check-".concat(o),classes:{paper:n.paper},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e.MenuProps),null===(t=e.options)||void 0===t?void 0:t.map((function(t,a){var o=t.key,c=t.value,i=t.text,l=t.selected,s=t.tooltipTitle,u=t.checked,p=t.checkboxValue,m=null;if("boolean"===typeof u){var d=r.a.createElement(W.a,{checked:u,onClick:O,value:void 0===p?c:p}),g=s||e.tooltipTitle;m=g?r.a.createElement(Y.a,{classes:{tooltip:n.tooltip,popper:n.popper},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!f,element:f}}}},title:r.a.createElement(r.a.Fragment,null,g,r.a.createElement("span",{className:n.arrow,ref:b})),enterDelay:void 0===e.tooltipEnterDelay?750:e.tooltipEnterDelay,leaveDelay:e.tooltipLeaveDelay||0,"aria-label":"checkbox",placement:e.tooltipPlacement||"top"},d):d}return r.a.createElement(G.a,Object.assign({key:o||a,onClick:y(c),selected:l},e.MenuItemProps),m,r.a.createElement(V.a,{primary:i||(null===c||void 0===c?void 0:c.toString())}))}))))},ne=Object(j.a)((function(e){return{root:function(e){return{}}}})),ae=function(e){var t,n=x(),o=ne(Object(M.a)(Object(M.a)({},e),n)),c=Object(a.useMemo)((function(){var e={deviceId:null,label:null,none:!0};return n.currentDeviceId?(n.cameras.some((function(t){return t.deviceId===n.currentDeviceId&&(e=t,!0)})),e):e}),[n.cameras,n.currentDeviceId]),i=Object(a.useCallback)((function(e){n.currentDeviceId!==e&&n.startVideo({deviceId:e})}),[n]),l=Object(a.useCallback)((function(e){n.autoStartDeviceId===e?n.clearAutoStartDeviceId():(n.setAutoStartDeviceId(e),i(e))}),[n,i]);return r.a.createElement("div",{className:o.root},r.a.createElement(te,{activeTitle:"Select Camera",title:(null===(t=n.cameras)||void 0===t?void 0:t.length)?c.label||"No Camera Selected":"No Cameras Detected",onSelect:i,onClickCheckbox:l,options:n.cameras.map((function(e){return{key:e.label,value:e.deviceId,text:e.label||"Unknown Device",selected:e.deviceId===n.currentDeviceId,checked:n.autoStartDeviceId===e.deviceId,tooltipTitle:n.autoStartDeviceId===e.deviceId?"Remove Default":"Set Default"}}))}))},re=Object(j.a)((function(e){return{root:{position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"},paper:{padding:e.spacing(2),borderRadius:e.spacing(1),display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center","& h1":{marginBottom:e.spacing(2)},"& p":{marginBottom:e.spacing(1)}}}})),oe=function(e){var t=re(e),n=Object(P.c)({transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-500px,0)"},config:P.b.slow}),a=Object(P.c)({to:{opacity:e.permissionDenied?1:0},config:P.b.wobbly});return r.a.createElement("div",{className:t.root},r.a.createElement(P.a.div,{style:n},r.a.createElement(N.a,{elevation:4,className:t.paper},r.a.createElement("div",{className:t.container},e.permissionDenied?r.a.createElement(P.a.div,{style:a},r.a.createElement(v.a,{component:"h1",variant:"h6"},"It looks like you have denied webcam access."),r.a.createElement(v.a,{component:"p"},"Please take a look at"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://support.google.com/chrome/answer/2693767"},"this article")," ","in order to enable access."),r.a.createElement(v.a,{component:"p"},"Once your webcam has been enabled, return here to play the game!")):r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{component:"h1",variant:"h6"},"In order to play the game, you must grant permission to access your webcam."),r.a.createElement(v.a,{component:"p"},"Please select a camera."),r.a.createElement(ae,null))))))},ce=n(301),ie=n.n(ce),le=n(302),se=n.n(le),ue=n(303),pe=n.n(ue),me=n(304),de=n.n(me),fe=Object(j.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between","& > *":{marginLeft:e.spacing(1)}}}})),be=function(e){var t=fe(),n=e.controller,a=n.onHomeScreen,o=n.handleBack,c=n.toggleAudio,i=n.audioState,l=n.openHelp,s=Object(P.c)({to:{opacity:a?0:1},config:P.b.stiff});return r.a.createElement("div",{className:t.root},!a&&r.a.createElement(P.a.div,{style:s},r.a.createElement(Z,{onClick:o,Icon:ie.a})),!e.isFullScreen&&r.a.createElement(ae,null),r.a.createElement(Z,{onClick:c,Icon:i?se.a:pe.a}),!e.isFullScreen&&r.a.createElement(Z,{onClick:l,Icon:de.a}))},ge=Object(j.a)((function(e){return{root:function(t){var n=t.isFullScreen;return Object(M.a)(Object(T.a)({maxWidth:1100,margin:"0 auto",position:"relative",height:"calc(0.5625 * (100vw - ".concat(e.spacing(4),"px))")},"@media(min-width: ".concat(1100,"px)"),{height:n?"100%":"calc(0.5625 * (".concat(1100,"px - ").concat(e.spacing(4),"px))")}),n?{display:"flex",alignItems:"center",justifyContent:"center"}:{})},container:function(t){var n=t.isFullScreen;return{width:"100%",position:"relative",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},video:function(t){var n=t.flipX,a=t.isFullScreen;return Object(M.a)({width:"100%",height:"100%",borderRadius:a?0:e.spacing(1)},n?{"p-webkit-transform":"scaleX(- 1)",transform:"scaleX(-1)"}:{})},canvas:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),position:"absolute",top:0,left:0,width:"100%",paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},children:function(t){var n=t.isFullScreen;return{borderRadius:n?0:e.spacing(1),overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",bottom:5,zIndex:1,paddingLeft:n?0:e.spacing(2),paddingRight:n?0:e.spacing(2)}},fullScreen:{position:"absolute",bottom:e.spacing(1.5),right:function(t){var n=t.isFullScreen;return e.spacing(n?1.5:3)},zIndex:20},overlay:function(t){var n=t.overlayColor,a=t.isFullScreen;return{background:n,position:"absolute",top:0,bottom:5,left:a?0:e.spacing(2),right:a?0:e.spacing(2),borderRadius:a?0:e.spacing(1),zIndex:0}},loader:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",display:"flex",alignItems:"center",justifyContent:"center","& > div":{width:100,height:100}},paper:{top:0,bottom:5,zIndex:-1,position:"absolute",left:e.spacing(2),right:e.spacing(2),borderRadius:e.spacing(1)},buttons:{position:"absolute",top:e.spacing(1.5),right:e.spacing(1.5),zIndex:20},logo:{position:"absolute",top:e.spacing(1.5),left:e.spacing(1.5),zIndex:20,width:34}}})),ve=function(e){var t,n,a,o,c,i,l,s,u=e.overlay,p=Object(R.a)(e,["overlay"]),m=x(),d="string"!==typeof u?"rgba(255,255,255,0.5)":u,f=ge(Object(M.a)(Object(M.a)(Object(M.a)({},p),m),{},{overlayColor:d})),b=Object(P.c)({to:{opacity:m.hidden?0:1},config:P.b.stiff});return r.a.createElement("div",{ref:m.rootRef,className:f.root},r.a.createElement(P.a.div,{style:b,className:f.container},r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{autoPlay:!0,ref:m.videoRef,className:f.video,width:null===(t=m.videoRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.videoWidth,height:null===(a=m.videoRef)||void 0===a||null===(o=a.current)||void 0===o?void 0:o.videoHeight}),r.a.createElement("canvas",{ref:m.canvasRef,className:f.canvas,width:null===(c=m.videoRef)||void 0===c||null===(i=c.current)||void 0===i?void 0:i.videoWidth,height:null===(l=m.videoRef)||void 0===l||null===(s=l.current)||void 0===s?void 0:s.videoHeight}),!m.hidden&&u&&r.a.createElement("div",{className:f.overlay}),p.children&&!m.hidden&&r.a.createElement("div",{className:f.children},p.children),m.hasFullScreen&&r.a.createElement(Z,{className:f.fullScreen,onClick:m.toggleFullScreen,Icon:m.isFullScreen?F.a:A.a})),!m.isFullScreen&&r.a.createElement(N.a,{elevation:4,className:f.paper}),m.isFullScreen&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:f.buttons},r.a.createElement(be,{controller:p.headerController,isFullScreen:!0})),r.a.createElement("img",{className:f.logo,alt:"Carbon Copy Logo",src:_.a}))),m.permissionNeeded?r.a.createElement(oe,{permissionDenied:m.permissionDenied}):m.hidden&&r.a.createElement("div",{className:f.loader},r.a.createElement("div",null,r.a.createElement(B,{color:"#000"}))))},he=n(2165),Oe=n(2151),ye=n(2152),je=n(89),ke=n.n(je),Ce=Object(j.a)((function(e){return{closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},ever:{fontWeight:"bold",fontStyle:"italic"}}})),Ee=Object(a.memo)((function(e){var t=e.open,n=e.handleClose,a=Ce();return r.a.createElement(he.a,{onClose:n,"aria-labelledby":"information",open:t,className:a.dialogRoot},r.a.createElement(Oe.a,{disableTypography:!0,id:"information"},r.a.createElement(v.a,{variant:"h5"},"Carbon Copy Fun!"),r.a.createElement(K.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(ke.a,null))),r.a.createElement(ye.a,{dividers:!0,className:a.dialogContent},r.a.createElement(v.a,{component:"h2",variant:"h6"},"Setup"),r.a.createElement(v.a,{gutterBottom:!0},"Place your webcam so that your entire body fits within the frame, and ensure there is enough space around you to move safely."),r.a.createElement(v.a,{gutterBottom:!0},"Be prepared to move side to side, forward and back, and even crouch."),r.a.createElement(v.a,{component:"h2",variant:"h6"},"Performance"),r.a.createElement(v.a,{gutterBottom:!0},"This game relies on state-of-the-art computer vision algorithms in order to detect the location of your body. This requires significant compute power. Don't be afraid if you hear your computer making noise."),r.a.createElement(v.a,{component:"h2",variant:"h6"},"Privacy"),r.a.createElement(v.a,{gutterBottom:!0},"Although this game requires your webcam to function, no personal images or data are collected by this application.")))})),we=Object(j.a)((function(e){return{root:{marginTop:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),width:"100%",maxWidth:1100,display:"flex",margin:"0 auto",alignItems:"center",justifyContent:"space-between"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},ever:{fontWeight:"bold",fontStyle:"italic"},title:{display:"flex",alignItems:"center","& > img":{width:34,marginRight:e.spacing(1)},"& > h1":{}}}})),xe=Object(a.memo)((function(e){var t=we();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.title},r.a.createElement("img",{src:_.a,alt:"Carbon Copy Logo"}),r.a.createElement(v.a,{variant:"h4",component:"h1"},"Carbon Copy")),r.a.createElement(be,{controller:e.controller})),r.a.createElement(Ee,{open:e.controller.helpOpen,handleClose:e.controller.closeHelp}))})),Se=Object(j.a)((function(e){return{heading:{marginLeft:e.spacing(2)}}})),Ie=function(e){var t,n,a,o,c=Se(),i=x(),l=Ga(),s=Object(P.c)({to:{opacity:i.hidden?0:1},config:P.b.stiff}),u=i.hidden?"":(null===l||void 0===l||null===(t=l.screen)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.mode)||("play"===(null===l||void 0===l||null===(a=l.screen)||void 0===a||null===(o=a.state)||void 0===o?void 0:o.screen)?"Choose Mode":"Select Players");return r.a.createElement(v.a,{component:"h1",variant:"h6",className:c.heading},r.a.createElement(P.a.div,{style:s},u))},Re="set_screen",Te="set_player_mode",Me="set_game_mode",Ne="reverse_state",Pe="reset_state",Le={screen:{DEFAULT:"start",PLAY:"play"},players:{SINGLE_PLAYER:"Single Player",MULTIPLAYER:"Multi Player",DEFAULT:null},mode:(s={},Object(T.a)(s,"Single Player",{PRACTICE:"Practice",SURVIVAL:"Survival",TIME_ATTACK:"Time Attack"}),Object(T.a)(s,"Multi Player",{LOCAL:"Local",REMOTE:"P2P"}),Object(T.a)(s,"DEFAULT",null),s)},Ae=Object.entries(Le).reduce((function(e,t){var n=Object(m.a)(t,2),a=n[0],r=n[1];return Object(M.a)(Object(M.a)({},e),{},Object(T.a)({},a,"mode"!==a?Object.values(r).filter((function(e){return e})):Object.entries(r).reduce((function(e,t){var n=Object(m.a)(t,2),a=n[0],r=n[1];return Object(M.a)(Object(M.a)({},e),{},Object(T.a)({},a,null===r?null:Object.values(r)))}),{})))}),{}),De={screen:Le.screen.DEFAULT,mode:Le.mode.DEFAULT,players:Le.players.DEFAULT},Fe=(p={},Object(T.a)(p,Le.screen.DEFAULT,Object(T.a)({},Le.players.DEFAULT,null)),Object(T.a)(p,Le.screen.PLAY,(u={},Object(T.a)(u,Le.players.SINGLE_PLAYER,null),Object(T.a)(u,Le.players.MULTIPLAYER,null),u)),p),Ue=function(e){var t,n=e.screenState,a=n.screen,o=n.players,c=(null===(t=Fe[a])||void 0===t?void 0:t[o])||Ie;return r.a.createElement("header",null,r.a.createElement(c,null))},_e=function(){return null},Be=n(2146),ze=n(307),Ye=n.n(ze),Ge=function(e){var t=(e-25)/63;return Math.max(1,Math.min(10,Math.round(10*t)))},We=function(e,t){var n,a;e<50?(n=255,a=Math.round(5.1*e)):(a=255,n=Math.round(510-5.1*e));var r="#"+("000000"+(65536*n+256*a+0).toString(16)).slice(-6);if(t)try{var o=Ye()(r),c=o.red,i=o.green,l=o.blue;return"rgba(".concat(c,", ").concat(i,", ").concat(l,", ").concat(t,")")}catch(s){return console.error(s,{score:e,alpha:t,hex:r}),"rgba(255, 255, 255, 0)"}return r},Ve=function(e,t){return We(function(e){return(e=Math.min(Math.max(e,0),10))/10*100}(e),t)},Je=Object(Be.a)((function(e){return{masks:{padding:e.spacing(2),background:"rgba(255,255,255,0.5)"},masksHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},masksList:{display:"flex",flexFlow:"row wrap",justifyContent:"space-around"},maskContainer:{marginTop:e.spacing(2)},imgContainer:{width:200,position:"relative",border:"1px solid grey",padding:e.spacing(.5),borderRadius:e.spacing(1),"&:hover":{"& > div":{background:"rgba(255,0,0,0.65)"}}},img:{width:"100%",background:"rgba(0,0,0,0)"},removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}},actions:{"& > button":{marginRight:e.spacing(1),"& :last-of-type":{marginRight:0}}}}})),qe=function(e){var t=Je(),n=e.masks,a=e.onClose,o=e.title,c=e.actions,i=e.actionButtons,l=e.getDataUri,s=e.getImageChild,u=e.getPaperProps,p=e.PaperProps,m=void 0===p?{}:p;return!!(null===n||void 0===n?void 0:n.length)&&r.a.createElement(N.a,{className:t.masks,elevation:4},r.a.createElement("div",{className:t.masksHeader},"string"===typeof o?r.a.createElement(v.a,{variant:"h6",component:"h3"},o):o||null,c||i?r.a.createElement("div",{className:t.actions},i.map((function(e){var t=e.Icon,n=e.onClick,a=e.key;return r.a.createElement(K.a,{key:a,size:"small",onClick:n},r.a.createElement(t,null))}))):a&&r.a.createElement("div",{className:t.actions},r.a.createElement(K.a,{size:"small",onClick:a},r.a.createElement(ke.a,null)))),r.a.createElement("ul",{className:t.masksList},n.map((function(e,a){var o=l?l(e):e,c=u?u(e,a,n):{};return r.a.createElement("li",{key:o,className:t.maskContainer},r.a.createElement(N.a,Object.assign({elevation:4,className:t.imgContainer},m,c),s&&s(e,a),r.a.createElement("img",{src:o,className:t.img,alt:"mask #".concat(a)})))}))))},He=Object(Be.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),Xe=function(e){var t=e.results,n=e.handleClose,o=e.label,c=Object(R.a)(e,["results","handleClose","label"]),i=He(),l=Object(a.useMemo)((function(){var e=(t.reduce((function(e,t){return e+t.score}),0)/t.length).toFixed(1);return r.a.createElement(v.a,{variant:"h6",component:"h3"},o||r.a.createElement(r.a.Fragment,null,"Round Score: ",e))}),[t,o]),s=Object(a.useCallback)((function(e){return e.dataUri}),[]),u=Object(a.useCallback)((function(e){var t=e.score;return{style:{background:Ve(t,.4)}}}),[]),p=Object(a.useCallback)((function(e){var t=e.score;return r.a.createElement(v.a,{className:i.score},t)}),[i.score]);return r.a.createElement(qe,Object.assign({title:l,masks:t,onClose:n,getDataUri:s,getPaperProps:u,getImageChild:p},c))},Ke=n(138),$e=n.n(Ke),Ze=n(308),Qe=n.n(Ze),et=n(309),tt=n.n(et),nt=Object(Be.a)((function(e){return{removeMask:{top:0,left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",position:"absolute",transition:"all 100ms",justifyContent:"center","&:hover":{"& > button":{display:"inherit"}}},iconBtn:{display:"none",color:"black",backgroundColor:"rgba(255,255,255,0.5)","&:hover":{backgroundColor:"rgba(255,255,255,0.75)"},"&:active, &:focused":{backgroundColor:"rgba(255,255,255,0.9)"}}}})),at=function(e){var t=nt(),n=e.captureMasks,o=e.handlePlay,c=Object(a.useMemo)((function(){return[{key:"play",Icon:$e.a,onClick:o},{key:"download",Icon:Qe.a,onClick:n.downloadMasks},{key:"clear",Icon:ke.a,onClick:n.removeAllMasks}]}),[n.downloadMasks,n.removeAllMasks,o]),i=Object(a.useCallback)((function(e){return e.binary}),[]),l=Object(a.useCallback)((function(e,a){return r.a.createElement("div",{className:t.removeMask},r.a.createElement(K.a,{name:a,className:t.iconBtn,onClick:n.removeMask},r.a.createElement(tt.a,{fontSize:"large"})))}),[n.removeMask,t.removeMask,t.iconBtn]);return r.a.createElement(qe,{title:"Candidate Masks",getDataUri:i,masks:n.masks,actionButtons:c,getImageChild:l})},rt=Object(Be.a)((function(e){return{score:{textAlign:"right",paddingRight:e.spacing(1)}}})),ot=function(e){var t=Ga(),n=rt(),o=Object(a.useMemo)((function(){var e;return"time attack"===(null===t||void 0===t||null===(e=t.mode)||void 0===e?void 0:e.name)?{getPaperProps:function(e){var t=e.score;return{style:{background:Ve(Math.max(10.5-t,0),.4)}}},getImageChild:function(e){var t=e.score;return r.a.createElement(v.a,{className:n.score},t,"s")}}:{}}),[t,n.score]);if(!t.mode)return null;var c=t.mode,i=c.simpleGame,l=c.captureMasks,s=c.handlePlayCapturedMasks,u=c.resultsText,p="time attack"!==c.name||!t.loop.looping;return r.a.createElement(r.a.Fragment,null,p&&r.a.createElement(Xe,Object.assign({label:u,results:i.scores,handleClose:e.hideClose?null:i.clearScores},o)),l&&r.a.createElement(at,{captureMasks:l,handlePlay:s}))},ct=Object(j.a)((function(e){return{root:function(e){var t=e.flip,n=e.height,a=void 0===n?10:n,r=e.background;return{height:a,background:void 0===r?"rgba(255,255,255,0)":r,width:"100%",borderRadius:50,transform:"scaleX(".concat(t?-1:1,")"),pWebkitTransform:"scaleX(".concat(t?-1:1,")")}},filler:function(e){var t=e.completed;return{height:"100%",textAlign:"left",background:e.color,width:"".concat(t,"%"),borderRadius:"inherit"}}}})),it=function(e){var t=ct(e);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.filler}))},lt=n(28),st=n(112),ut=n.n(st),pt=n(310),mt=n.n(pt),dt=(n(311),function(e){var t=cv.matFromImageData(e),n=t.rows,a=t.cols,r=20*(Math.random()-.5),o=new cv.Mat,c=new cv.Point(a/2,n/2),i=cv.getRotationMatrix2D(c,r,1);cv.warpAffine(t,o,i,t.size(),cv.INTER_NEAREST,cv.BORDER_CONSTANT,new cv.Scalar(0,0,0,0));var l=new cv.MatVector;cv.split(o,l);var s=-1,u=-1,p=-1,m=-1,d=new cv.Mat,f=new cv.Mat;cv.reduce(l.get(2),d,0,cv.REDUCE_MAX);for(var b=0;b<a;++b)if(-1===s&&d.data[b]>0){s=b;break}for(var g=a-1;g>=0;g--)if(-1===p&&d.data[g]>0){p=g;break}cv.reduce(l.get(2),d,1,cv.REDUCE_MAX);for(var v=0;v<n;++v)if(-1===u&&d.data[v]>0){u=v;break}for(var h=n-1;h>=0;h--)if(-1===m&&d.data[h]>0){m=h;break}var O=p-s+1,y=m-u+1,j=new cv.Rect(s,u,O,y),k=a/(d=o.roi(j)).cols,C=n/d.rows,E=Math.min(k,C),w=Math.min(.9+Math.random()*(1.1-.9),E),x=new cv.Size(d.cols*w,d.rows*w);cv.resize(d,f,x,0,0,cv.INTER_NEAREST);var S=f.cols,I=f.rows,R=(a-S)/2,T=R+(Math.random()-.5)*(2*Math.min(300,R)),M=new cv.Rect(T,n-I,S,I),N=new cv.Mat.zeros(n,a,o.type());f.copyTo(N.roi(M));var P=new ImageData(new Uint8ClampedArray(N.data),N.cols,N.rows);return o.delete(),t.delete(),d.delete(),f.delete(),N.delete(),P}),ft=function(e,t){for(var n=e.data,a=e.width,r=e.height,o=new Uint8ClampedArray(4*e.data.length),c=0;c<r*a;++c){var i=c%a,l=parseInt(c/a),s=n[c],u=t?a-i+a*l:c;o[4*u]=s?255:0,o[4*u+1]=s?255:0,o[4*u+2]=s?255:0,o[4*u+3]=s?255:0}var p=new ImageData(o,a,r),m=cv.matFromImageData(p),d=new cv.MatVector;cv.split(m,d);var f=new cv.Mat;cv.threshold(d.get(0),f,128,1,cv.THRESH_BINARY);var b=new cv.MatVector,g=new cv.Mat;cv.findContours(f,b,g,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(var v=cv.Mat.zeros(f.rows,f.cols,cv.CV_8UC1),h=0;h<b.size();++h)cv.contourArea(b.get(h))>1e4&&cv.drawContours(v,b,h,[1,1,1,1],-1,cv.LINE_8,g,100);return m.delete(),d.delete(),v},bt=function(e,t){var n=ft(e,t),a=new cv.MatVector,r=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC4);cv.split(r,a),a.get(2).setTo([255,0,0,0],n),a.get(3).setTo([128,0,0,0],n);var o=new cv.Mat,c=cv.Mat.ones(10,10,cv.CV_8U),i=new cv.Point(-1,-1);cv.dilate(n,o,c,i,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(o,n,o),a.get(2).setTo([255,0,0,0],o),a.get(1).setTo([255,0,0,0],o),a.get(3).setTo([255,0,0,0],o),cv.merge(a,r);var l=new ImageData(new Uint8ClampedArray(r.data),r.cols,r.rows);return a.delete(),n.delete(),r.delete(),c.delete(),o.delete(),{overlayImageData:l,binaryImageData:l}},gt=function(e,t,n){for(var a=t.data,r=t.width,o=t.height,c=0,i=0,l=0;l<o*r;++l){var s=l%r,u=parseInt(l/r),p=n?r-s+r*u:l,m=a[l],d=!!e.data[4*p+2],f=m?1.3:1;d&&m&&(i+=f),(m||d)&&(c+=f)}return Math.round(i/(c+1e-7)*100)},vt=function(e,t,n){var a=ft(t,n),r=new cv.MatVector,o=cv.Mat.zeros(a.rows,a.cols,cv.CV_8UC4);cv.split(o,r),r.get(1).setTo([255,0,0,0],a),r.get(3).setTo([128,0,0,0],a);var c=new cv.Mat,i=cv.Mat.ones(10,10,cv.CV_8U),l=new cv.Point(-1,-1);cv.dilate(a,c,i,l,1,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),cv.subtract(c,a,c),r.get(1).setTo([255,0,0,0],c),r.get(3).setTo([255,0,0,0],c),cv.merge(r,o);var s=new ImageData(new Uint8ClampedArray(o.data),o.cols,o.rows),u=cv.matFromImageData(e),p=new cv.MatVector;cv.split(u,p);var m=new cv.Mat;cv.addWeighted(o,.5,u,.5,0,m);var d=new ImageData(new Uint8ClampedArray(m.data),m.cols,m.rows),f=gt(e,t,n);return r.delete(),a.delete(),o.delete(),i.delete(),c.delete(),m.delete(),{score:f,targetOverlay:d,segOverlay:s}},ht=function(e,t){if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,t);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,t);var n=window.document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(n),"function"===typeof n.click?n.click():(n.target="_blank",n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(n.href)},Ot=function(e){return"set".concat(e,".zip")},yt=function(e){var t=x(),n=Object(a.useState)(!1),r=Object(m.a)(n,2),o=r[0],c=r[1],i=Object(a.useCallback)(function(){var n=Object(E.a)(C.a.mark((function n(a){var r,o,i;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ut.a.loadAsync(a);case 2:return r=n.sent,n.next=5,Promise.all(r.filter((function(e){return e.endsWith(".png")})).map((function(e){var t=e.name;return r.file(t).async("base64")})));case 5:return o=n.sent,n.prev=6,n.next=9,Promise.all(o.map((function(e){return t.dataUriToImageData("data:image/png;base64,".concat(e))})));case 9:i=n.sent,e(i),n.next=15;break;case 13:n.prev=13,n.t0=n.catch(6);case 15:c(!1);case 16:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e){return n.apply(this,arguments)}}(),[e,t]),l=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(m.a)(t,1),"application/zip"===(a=n[0]).type){e.next=4;break}return console.error("Expected a zip file but got",a.type),e.abrupt("return");case 4:return c(!0),e.next=7,i(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),s=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(t){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return c(!0),e.next=5,new ut.a.external.Promise((function(e,n){mt.a.getBinaryContent(""+"/masks/".concat(t),(function(t,a){t?n(t):e(a)}))}));case 5:return n=e.sent,e.next=8,i(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),u=Object(a.useCallback)(Object(E.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.floor(3*Math.random()),e.abrupt("return",s(Ot(t+1)));case 2:case"end":return e.stop()}}),e)}))),[s]);return Object(a.useMemo)((function(){return{loading:o,handleZipInputChange:l,handleLoadRandomMaskSet:u,handleLoadPreparedMasks:s}}),[o,l,s,u])};var jt,kt,Ct,Et,wt,xt=function(e){if(!e)throw new Error("audioRef is required when calling useSfx");var t=Object(a.useCallback)((function(t){if(e.current)return function(e){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var t=new AudioContext,n=t.createBufferSource(),a=new Request(e);return fetch(a).then((function(e){return e.arrayBuffer()})).then((function(e){return t.decodeAudioData(e,(function(e){n.buffer=e,n.connect(t.destination)})),n.start(0)}))}(t)}),[e]);return{playSuccessSound:Object(a.useCallback)((function(){return t("/sounds/metallic_clank.ogg")}),[t]),playFailureSound:Object(a.useCallback)((function(){return t("/sounds/glass_shatter.ogg")}),[t]),playCameraSound:Object(a.useCallback)((function(){return t("/sounds/camera.ogg")}),[t])}},St=window.speechSynthesis,It=function(){var e=Object(a.useRef)(!0),t=Object(a.useState)(!0),n=Object(m.a)(t,2),r=n[0],o=n[1],c=function(e){if(!e)throw new Error("audioRef is required when calling useSpeech");var t=Object(a.useState)(null),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(null),i=Object(m.a)(c,2),l=i[0],s=i[1];Object(a.useEffect)((function(){if(!r){var e=St.getVoices();o(e),s(e[0])}}),[r]);var u=Object(a.useCallback)((function(t){if(e.current){var n=new SpeechSynthesisUtterance(t);n.voice=l,St.speak(n)}}),[l,e]),p=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.onEnd,a=t.onEach;n&&setTimeout(n,1e3*e),Array.from({length:e}).forEach((function(t,n){var r=e-n;setTimeout((function(){u(r),a&&a(r)}),1e3*n)}))}),[u]);return{say:u,countdown:p}}(e),i=xt(e);Object(a.useEffect)((function(){localStorage.getItem("__audio_muted__")&&o(!1)}),[]),Object(a.useEffect)((function(){r&&!e.current?(e.current=!0,localStorage.removeItem("__audio_muted__")):!r&&e.current&&(e.current=!1,localStorage.setItem("__audio_muted__","true"))}),[r]);var l=Object(a.useCallback)((function(){o((function(e){return!e}))}),[]);return Object(a.useMemo)((function(){return{state:r,stateRef:e,handlers:{toggle:l,speech:c,sfx:i}}}),[r,l,c,i])},Rt=Object(a.createContext)(),Tt=function(){var e=Object(a.useContext)(Rt);if(void 0===e)throw new Error("useAudio must be used within a AudioProvider");return e},Mt=function(e){var t=e.children,n=It();return r.a.createElement(Rt.Provider,{value:n},t)},Nt=function(){var e=Object(a.useRef)([]),t=Object(a.useRef)(null),n=Object(a.useRef)(0),r=Object(a.useState)([]),o=Object(m.a)(r,2),c=o[0],i=o[1],l=Object(a.useCallback)((function(t){i(t),e.current="function"===typeof t?t(e.current):t}),[]),s=Object(a.useCallback)((function(){n.current=0,t.current=null}),[]),u=Object(a.useCallback)((function(){for(var t,n,a=c.slice(),r=a.length;0!==r;)n=Math.floor(Math.random()*r),t=a[r-=1],a[r]=a[n],a[n]=t;l(a),e.current=a}),[c,l]),p=Object(a.useCallback)((function(){n.current=0,t.current=null,u()}),[u]),d=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=e.current[n.current];if(!r)return t.current=null,n.current=0,null;if(a){var o=dt(r);return t.current=o,n.current++,o}return t.current=r,n.current++,r}),[]),f=Object(a.useCallback)((function(){return e.current.length}),[]),b=Object(a.useCallback)((function(){var e=c[Math.floor(Math.random()*c.length)],n=dt(e);return t.current=n,n}),[c]);return Object(a.useMemo)((function(){return{next:d,reset:s,random:b,maskRef:t,setMasks:l,maskIdxRef:n,getNumMasks:f,resetAndShuffle:p,hasMasks:!!c.length}}),[d,c,b,s,l,p,f])},Pt=Object(a.createContext)(),Lt=function(){var e=Object(a.useContext)(Pt);if(void 0===e)throw new Error("useCarbon must be used within a CarbonProvider");return e},At=function(e){var t=e.children,n=function(){var e=Tt().handlers.speech.say,t=Object(a.useRef)(),n=Object(a.useState)(!1),r=Object(m.a)(n,2),o=r[0],c=r[1];Object(a.useEffect)((function(){o&&!t.current?t.current=!0:!o&&t.current&&(t.current=!1)}),[o]);var i=Object(a.useCallback)((function(){c((function(t){return t||e("Carbon Activated!"),!t}))}),[e]);return window.__carbonate__=i,{carbonState:o,carbonRef:t}}();return r.a.createElement(Pt.Provider,{value:n},t)},Dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.setLapTimeInfo,n=Object(a.useRef)(),r=x(),o=Lt(),c=o.carbonRef,i=Object(a.useRef)(0),l=Nt(),s=Object(a.useRef)(0),u=Object(a.useState)([]),p=Object(m.a)(u,2),d=p[0],f=p[1],b=yt(l.setMasks),g=Xa(),v=Object(m.a)(g,2),h=v[0],O=v[1],y=Tt(),j=y.handlers,k=j.sfx,w=k.playSuccessSound,S=k.playFailureSound,I=j.speech.say,R=Object(a.useCallback)((function(){f([]),O([[],[]])}),[O]),T=Object(a.useCallback)((function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){var o=Object(E.a)(C.a.mark((function o(c){return C.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c.time.first&&(l.next(),e||R(),c.useTimer({maxLaps:l.getNumMasks(),setLapTimeInfo:t,announceSeconds:!0,onLap:function(t){var o=t.predict,c=(t.time,t.stop),i=l.maskRef.current;if(!i)return c();n.current=o(r.videoRef.current).then(function(){var t=Object(E.a)(C.a.mark((function t(n){var o,c,s,u,p;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=vt(i,n,r.flipX),c=o.score,s=o.targetOverlay,u=r.imageDataToDataUri(s),void 0!==e?(p={score:Ge(c),dataUri:u},a(p),O((function(t){var n=Object(lt.a)(t);return n[e]=[].concat(Object(lt.a)(n[e]),[p]),n}))):f((function(e){return[].concat(Object(lt.a)(e),[{score:Ge(c),dataUri:u}])})),r.clearCanvas(),l.next();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})),l.maskRef.current&&r.ctx.putImageData(l.maskRef.current,0,0),o.abrupt("return",(function(){n.current?n.current.then(c.webcam.clearCanvas):c.webcam.clearCanvas()}));case 3:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()}),[l,R,t,r,O]),M=Object(a.useCallback)((function(){return T()}),[T]),N=Object(a.useCallback)((function(e,t){return T(e,t)}),[T]),P=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.time.first&&(l.random(),R(),a.useTimer({maxLaps:9999999,lapDuration:1e4,setLapTimeInfo:t,announceSeconds:!0,onLap:function(e){var t=e.predict,o=(e.time,e.stop),i=l.maskRef.current;if(!i)return o();n.current=t(r.videoRef.current).then(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,s,u,p,m,d;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=vt(i,t,r.flipX),s=n.score,u=n.targetOverlay,4,(p=Ge(s))<4?c.current?I("Missed it!"):S():c.current?I("Got it!"):w(),m=r.imageDataToDataUri(u),f((function(e){return[].concat(Object(lt.a)(e),[{score:Ge(s),dataUri:m}])})),r.clearCanvas(),!(p<4)){e.next=12;break}return l.reset(),e.abrupt("return",o());case 12:d=a.timerRef.current.lapDuration/1e3,a.timerRef.current.lapDuration=1e3*(d-Math.log(d)/Math.log(50))-100,l.random();case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})),l.maskRef.current&&r.ctx.putImageData(l.maskRef.current,0,0),e.abrupt("return",(function(){n.current?n.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,l,t,R,c,S,w,I]),L=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.time.first&&(10,l.resetAndShuffle(),l.next(!0),R(),i.current=0,s.current=0,a.useTimer({setLapTimeInfo:t,announceSeconds:!1,lapDuration:250,postLapDelay:0,onLap:function(e){var t=e.predict,a=e.time,o=e.stop,u=l.maskIdxRef.current,p=l.maskRef.current;if(!p||i.current>=10)return o();if(!(i.current>=u||i.current>=10)){var m=a.elapsed-s.current;if(m/1e3>=10){s.current=a.elapsed,c.current?I("Missed it!"):S();var d=r.imageDataToDataUri(p);f((function(e){return[].concat(Object(lt.a)(e),[{score:10,dataUri:d}])})),r.clearCanvas(),i.current++,i.current<10&&l.next(!0)}n.current=t(r.videoRef.current).then(function(){var e=Object(E.a)(C.a.mark((function e(t){var n,o,d,b,g,v;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=gt(p,t,r.flipX),!(Ge(n)>5)){e.next=15;break}if(!(i.current>=u||i.current>=10)){e.next=5;break}return e.abrupt("return");case 5:c.current?I("Got it!"):w(),o=m/1e3,s.current=a.elapsed,d=Number(o.toFixed(1)),b=vt(p,t,r.flipX),g=b.targetOverlay,v=r.imageDataToDataUri(g),f((function(e){return[].concat(Object(lt.a)(e),[{score:d,dataUri:v}])})),r.clearCanvas(),i.current++,i.current<10&&l.next(!0);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(console.error)}}})),l.maskRef.current&&r.ctx.putImageData(l.maskRef.current,0,0),e.abrupt("return",(function(){n.current?n.current.then(a.webcam.clearCanvas):a.webcam.clearCanvas()}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,l,R,t,S,w,c,I]);return Object(a.useMemo)((function(){return{zip:b,scores:d,multiplayerScores:h,handleLoop:M,handleMultiplayerLoop:N,handleSurvivalLoop:P,handleTimeAttackLoop:L,clearScores:R,reset:l.reset,ready:l.hasMasks,setMasks:l.setMasks}}),[b,d,h,M,N,P,L,R,l.hasMasks,l.reset,l.setMasks])},Ft=n(312),Ut=n.n(Ft),_t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.maxMasks,n=void 0===t?0:t,r=e.setLapTimeInfo,o=Object(a.useRef)(),c=Object(a.useRef)([]),i=Object(a.useRef)(),l=Object(a.useState)([]),s=Object(m.a)(l,2),u=s[0],p=s[1],d=Lt(),f=d.carbonRef,b=Tt(),g=b.handlers,v=g.sfx.playCameraSound,h=g.speech.say,O=Object(a.useCallback)((function(e){"function"===typeof e?p((function(t){var n=e(t);return n!==t&&(c.current=n),n})):(c.current=e,p(e))}),[]),y=Object(a.useCallback)((function(){return c.current}),[]),j=Object(a.useCallback)((function(e){var t=e.currentTarget.name;O((function(e){return e.filter((function(e,n){return n!==+t}))}))}),[O]),k=Object(a.useCallback)((function(){O([])}),[O]),w=Object(a.useCallback)((function(){var e=new ut.a,t=e.folder("masks");u.forEach((function(e,n){var a=e.overlay;t.file("mask-".concat(n,".png"),Ut.a.decode(a).dataBase64,{base64:!0})})),e.generateAsync({type:"blob"}).then((function(e){return ht(e,"masks.zip")}))}),[u]),x=Object(a.useCallback)((function(e){return function(){var t=Object(E.a)(C.a.mark((function t(a){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.time.first&&(i.current=u.length,a.useTimer({announceSeconds:!0,lapDuration:3e3,postLapDelay:2500,maxLaps:n,setLapTimeInfo:r,onBeforeStartLap:function(){var e=Object(E.a)(C.a.mark((function e(t){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.predict,t.webcam,t.time,t.stop,e.abrupt("return",n());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onLap:function(e){var t=e.predict,a=e.webcam,r=(e.time,e.stop);o.current=t(a.videoRef.current).then(function(){var e=Object(E.a)(C.a.mark((function e(t){var o,c,l,s,u;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=bt(t,a.flipX),c=o.overlayImageData,l=o.binaryImageData,f.current?h("Gotcha!"):v(),s=a.imageDataToDataUri(c),u=a.imageDataToDataUri(l),a.clearCanvas(),a.ctx.putImageData(c,0,0),O((function(e){return[].concat(Object(lt.a)(e),[{overlay:s,binary:u}])})),e.next=9,new Promise((function(e){return setTimeout(e,1500)}));case 9:if(a.clearCanvas(),!(n&&++i.current>n)){e.next=12;break}return e.abrupt("return",r());case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onEnd:function(){var e=Object(E.a)(C.a.mark((function e(t){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.time,n=t.webcam,t.predict,t.stop,e.next=3,new Promise((function(e){return setTimeout(e,2e3)}));case 3:n.clearCanvas();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),t.abrupt("return",(function(){o.current?o.current.then(a.webcam.clearCanvas).then((function(){e&&e()})):(a.webcam.clearCanvas(),e&&e())}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),[u.length,n,r,O,v,h,f]);return Object(a.useMemo)((function(){return{masks:u,getMasks:y,handleLoop:x,removeMask:j,downloadMasks:w,removeAllMasks:k}}),[u,y,x,j,w,k])},Bt={percent:0,percentRemaining:100,color:We(100),secondsRemaining:0},zt=function(e){var t=Object(a.useState)(Bt),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Dt({setLapTimeInfo:o}),i=_t({setLapTimeInfo:o}),l=Object(a.useMemo)((function(){var e,t;return"You survived ".concat((null===c||void 0===c||null===(e=c.scores)||void 0===e?void 0:e.length)-1," round").concat(2!==(null===c||void 0===c||null===(t=c.scores)||void 0===t?void 0:t.length)?"s":"",".")}),[c.scores]),s=Object(a.useRef)(!1);Object(a.useEffect)((function(){s.current||(s.current=!0,c.zip.handleLoadPreparedMasks("custom_mask.zip"))}),[c]);var u=Object(a.useCallback)(Object(E.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.looping?e.stop():e.start(c.handleSurvivalLoop);case 1:case"end":return t.stop()}}),t)}))),[e,c]),p=Object(a.useCallback)((function(){e.looping?e.stop():e.start(i.handleLoop())}),[e,i]);return Object(a.useMemo)((function(){return{name:"survival",loop:e,simpleGame:c,lapTimeInfo:r,resultsText:l,captureMasks:i,handleClickGame:u,handleClickCaptureMasks:p}}),[e,c,r,l,i,u,p])},Yt=n(2153),Gt=n(314),Wt=n.n(Gt),Vt=n(313),Jt=n.n(Vt),qt=Object(Be.a)((function(e){return{paper:{position:"relative",padding:e.spacing(1),paddingRight:e.spacing(5),paddingLeft:e.spacing(5),background:"rgba(255,255,255,0.95)",paddingBottom:e.spacing(2),marginTop:e.spacing(2),textAlign:"center","& h2":{marginBottom:e.spacing(4)},"& h3":{marginBottom:e.spacing(1)}},help:{maxHeight:200,marginTop:e.spacing(2),"& > div > p":{marginBottom:e.spacing(1)}},helpBtn:{position:"absolute",bottom:e.spacing(1),right:e.spacing(1),color:e.palette.secondary.main,background:e.palette.primary.main,transition:"300ms all","&:hover":{color:e.palette.primary.main,background:e.palette.secondary.main}},icon:{fontSize:50},marginTop:{marginTop:e.spacing(2)},helpContent:{fontWeight:600,fontFamily:$a("Rajdhani"),fontSize:18}}})),Ht=function(e){var t=e.headerContent,n=e.middleContent,o=e.footerContent,c=e.primaryText,i=e.secondaryText,l=e.helpContent,s=e.iconProps,u=(s=void 0===s?{}:s).loading,p=Object(R.a)(s,["loading"]),d=e.Icon,f=Object(a.useState)(!1),b=Object(m.a)(f,2),g=b[0],h=b[1],O=Object(a.useCallback)((function(){h((function(e){return!e}))}),[]),y=qt(),j=Object(a.useMemo)((function(){return u?Yt.a:{play:$e.a,replay:Jt.a}[d]||d}),[d,u]);return r.a.createElement(N.a,{className:y.paper},t,c&&r.a.createElement(v.a,{component:"h3",variant:"h5"},c),n,i&&r.a.createElement(v.a,{component:"h4",variant:"h6",className:X()(y.subtext,Object(T.a)({},y.marginTop,n))},i),j&&r.a.createElement(K.a,Object.assign({size:"medium",disabled:u},p),r.a.createElement(j,{className:y.icon,color:p.color||"secondary"})),o,l&&r.a.createElement("div",{className:y.help},g&&r.a.createElement("div",{className:y.helpContent},Array.isArray(l)?r.a.createElement(r.a.Fragment,null,l.map((function(e){return r.a.createElement("p",{key:e},e)}))):l),r.a.createElement(K.a,{size:"small",className:y.helpBtn,onClick:O},r.a.createElement(Wt.a,null))))},Xt=Object(Be.a)((function(e){return{root:{padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},options:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > *":{marginTop:e.spacing(2)}},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),Kt=function(e,t,n){return t===n.length-1?{style:{background:"rgba(255, 0, 0, 0.4)"}}:{}},$t=function(e){var t=Xt(),n=Wa(zt),a=x(),o=n.loop,c=n.lapTimeInfo,i=n.handleClickGame;return r.a.createElement("div",{className:X()(t.root,Object(T.a)({},t.overlay,!o.looping))},r.a.createElement("div",{className:X()(t.options,Object(T.a)({},t.optionsTop,!!o.looping))},o.looping?r.a.createElement("div",{className:t.progress},r.a.createElement(it,{color:c.color,completed:c.percentRemaining})):r.a.createElement(Ht,{primaryText:"Survival",secondaryText:"Match the poses and survive as long as you can.",middleContent:a.isFullScreen&&r.a.createElement(Zt,null),Icon:"play",iconProps:{onClick:i,loading:!o.ready,color:"secondary"},helpContent:["You will have a limited number of time to match each pose.","Successfully match a pose by being within its lines when the timer runs out.","If your score is high enough, you will move on to the next round.","You will have less time each round.","How long can you survive?"]})))},Zt=function(e){var t=Ga();if(!t.mode)return null;var n=t.mode,a=n.simpleGame,o=n.resultsText;return!t.loop.looping&&r.a.createElement(Xe,{label:o,getImageChild:null,results:a.scores,handleClose:a.clearScores,getPaperProps:Kt})},Qt=Object(Be.a)((function(e){return{root:function(t){return{minWidth:t.isFullScreen?"50%":"auto","& > div:first-of-type":{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}}})),en=function(e){var t=Ga(),n=Qt(e);if(!t.mode)return null;var a=t.mode,o=a.simpleGame,c=a.multiplayerResultsText;return!t.loop.looping&&r.a.createElement("div",{className:n.root},r.a.createElement(Xe,{label:c[0],results:o.multiplayerScores[0]}),r.a.createElement(Xe,{label:c[1],results:o.multiplayerScores[1]}))},tn=Object(j.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),"& > div":{marginTop:e.spacing(2)}}}})),nn=Object(T.a)({},Le.screen.PLAY,(Ct={},Object(T.a)(Ct,Le.players.SINGLE_PLAYER,(jt={},Object(T.a)(jt,Le.mode[Le.players.SINGLE_PLAYER].PRACTICE,ot),Object(T.a)(jt,Le.mode[Le.players.SINGLE_PLAYER].SURVIVAL,Zt),Object(T.a)(jt,Le.mode[Le.players.SINGLE_PLAYER].TIME_ATTACK,ot),jt)),Object(T.a)(Ct,Le.players.MULTIPLAYER,(kt={},Object(T.a)(kt,Le.mode[Le.players.MULTIPLAYER].LOCAL,en),Object(T.a)(kt,Le.mode[Le.players.MULTIPLAYER].REMOTE,en),kt)),Ct)),an=function(e){var t,n,a=tn(),o=e.screen.state,c=o.screen,i=o.players,l=o.mode,s=(null===(t=nn[c])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[l])||_e;return r.a.createElement("div",{className:a.root},r.a.createElement(s,null))},rn=n(317),on=n.n(rn),cn=n(315),ln=n.n(cn),sn=n(316),un=n.n(sn),pn=n(318),mn=n.n(pn),dn=n(319),fn=n.n(dn),bn=n(2154),gn=Object(Be.a)((function(e){return{root:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"space-between",marginBottom:e.spacing(1),"& > div > *":{marginTop:e.spacing(2)}},buttons:{display:"flex"},h:{flexDirection:"row"},v:{flexDirection:"column"},minWidth:{minWidth:150},label:{color:e.palette.primary.main,fontWeight:"bold",background:e.palette.secondary.main,padding:e.spacing(1),borderRadius:e.spacing(1),border:"".concat(e.spacing(.4),"px solid ").concat(e.palette.primary.main)},icon:{fontSize:100,border:"".concat(e.spacing(.4),"px solid ").concat(e.palette.secondary.main),borderRadius:"50%",padding:e.spacing(1),background:e.palette.primary.main,color:"black",transition:"300ms all","&:hover":{border:"".concat(e.spacing(.4),"px solid ").concat(e.palette.primary.main),background:e.palette.secondary.main,color:e.palette.primary.main}}}})),vn=function(e){return{transform:"translate3d(0,0px,0)",from:{transform:"translate3d(0,-".concat(e,"px,0)")},config:P.b.wobbly}},hn=function(e){var t,n=gn(),o=Object(P.d)(e.buttons.length,vn(e.offset||100)),c=Object(P.d)(1,vn((e.offset||100)+200)),i=Object(a.useState)(e.label),l=Object(m.a)(i,2),s=l[0],u=l[1];return r.a.createElement("div",{className:n.root},e.label&&c.map((function(e,t){return r.a.createElement(P.a.div,{style:e,key:t},r.a.createElement(v.a,{component:"h2",variant:"h5",className:n.label},s))})),r.a.createElement("div",{className:X()(n.buttons,(t={},Object(T.a)(t,n.h,"h"===e.layout),Object(T.a)(t,n.v,"h"!==e.layout),t))},o.map((function(t,a){var o=e.buttons[a],c=o.Component,i=o.visible,l=void 0===i||i,s=o.props,p=(s=void 0===s?{}:s).Icon,m=s.hover,d=Object(R.a)(s,["Icon","hover"]),f={};return m&&d.name&&e.label&&(f.onMouseEnter=function(){u(d.name)},f.onMouseLeave=function(){u(e.label)}),l?r.a.createElement(P.a.div,{key:d.key,style:t},c?r.a.createElement(c,d):p?r.a.createElement(K.a,Object.assign({size:"medium",variant:"contained",className:n.iconButton},f,d),r.a.createElement(p,{className:n.icon})):r.a.createElement(bn.a,Object.assign({color:"secondary",variant:"contained"},d,{className:n.minWidth}))):null}))))},On=Object(j.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column","& button":{marginTop:e.spacing(2)}},gameMode:{textAlign:"center"},header:{marginTop:e.spacing(4),marginBottom:e.spacing(2)}}})),yn=(Et={},Object(T.a)(Et,Le.mode["Single Player"].SURVIVAL,ln.a),Object(T.a)(Et,Le.mode["Single Player"].PRACTICE,un.a),Object(T.a)(Et,Le.mode["Single Player"].TIME_ATTACK,on.a),Object(T.a)(Et,Le.mode["Multi Player"].LOCAL,mn.a),Object(T.a)(Et,Le.mode["Multi Player"].REMOTE,fn.a),Et),jn=function(e){var t=On(),n=Lt().carbonState,o=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.screen.handlers.setGameMode(n)}),[e.screen.handlers]),c=Object(a.useMemo)((function(){var t;return null===(t=Ae.mode[e.screen.state.players])||void 0===t?void 0:t.map((function(e){return{props:{key:e,name:e,children:e,onClick:o,Icon:yn[e],hover:!0}}})).filter((function(e){return!!n||"Practice"!==e.props.name}))}),[e.screen.state.players,o,n]);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.gameMode},r.a.createElement(hn,{buttons:c,label:"Choose Mode",layout:"h"})))},kn=Object(j.a)((function(e){return{fileInput:{display:"none"}}})),Cn=function(e){var t=e.onChange,n=e.multiple,o=e.children,c=e.filter,i=Object(R.a)(e,["onChange","multiple","children","filter"]),l=kn(),s=Object(a.useRef)(),u=Object(a.useCallback)((function(e){if(e){var a=!1===n,r=e.target?Array.from(e.target.files):e.files,o=c?r.filter(c):r;a&&o.length>1&&(o=o.slice(0,1)),t(o)}}),[t,n,c]),p=Object(a.useCallback)((function(){s.current.value=null}),[s]);return r.a.createElement(bn.a,Object.assign({component:"label"},i),o,r.a.createElement("input",{type:"file",ref:s,className:l.fileInput,onClick:p,onChange:u,multiple:!1!==n}))},En=Object(Be.a)((function(e){return{item:function(t){return{minWidth:t-e.spacing(4),textAlign:"center"}}}})),wn=function(e){var t=Object(a.useState)(0),n=Object(m.a)(t,2),o=n[0],c=n[1],i=En(o),l=Object(a.useRef)();Object(a.useEffect)((function(){l.current&&c(l.current.clientWidth)}),[]);var s=r.a.useState(null),u=Object(m.a)(s,2),p=u[0],d=u[1],f=Object(a.useCallback)((function(e){d(e.currentTarget)}),[]),b=Object(a.useCallback)((function(){d(null)}),[]),g=Object(a.useCallback)((function(t){return function(){e.handleClick(t),b()}}),[e,b]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:l},r.a.createElement(bn.a,{fullWidth:!0,variant:"contained","aria-haspopup":"true",onClick:f,"aria-controls":"mask-menu",disabled:e.disabled},"Select Masks")),r.a.createElement(z.a,{id:"mask-menu",keepMounted:!0,anchorEl:p,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:b,open:Boolean(p),container:e.containerRef.current||null},Array.from({length:3}).map((function(e,t){return r.a.createElement(G.a,{key:t,button:!0,onClick:g("set".concat(t+1,".zip"))},r.a.createElement("span",{className:i.item},"Game ",t+1))}))))},xn=function(e){var t=x(),n=Object(a.useState)(Bt),r=Object(m.a)(n,2),o=r[0],c=r[1],i=Dt({setLapTimeInfo:c}),l=_t({setLapTimeInfo:c}),s=Object(a.useState)(null),u=Object(m.a)(s,2),p=u[0],d=u[1];Object(a.useEffect)((function(){!e.looping&&p&&d(null)}),[e.looping,p]);var f=Object(a.useCallback)(Object(E.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.looping?(e.stop(),i.reset()):(e.start(i.handleLoop),d("play"));case 1:case"end":return t.stop()}}),t)}))),[e,i]),b=Object(a.useCallback)(Object(E.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.looping){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,i.zip.handleLoadRandomMaskSet();case 4:f();case 5:case"end":return t.stop()}}),t)}))),[f,e.looping,i.zip]),g=Object(a.useCallback)((function(){e.looping?(e.stop(),i.reset()):(e.start(l.handleLoop()),d("capture"))}),[e,l,i]),v=Object(a.useCallback)(Object(E.a)(C.a.mark((function n(){var a;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.looping){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Promise.all(l.masks.map((function(e){var n=e.overlay;return t.dataUriToImageData(n)})));case 4:a=n.sent,i.setMasks(a),f();case 7:case"end":return n.stop()}}),n)}))),[l.masks,i,t,f,e.looping]);return Object(a.useMemo)((function(){return{name:"practice",loopType:p,simpleGame:i,lapTimeInfo:o,captureMasks:l,handleClickGame:f,handleStartRandomGame:b,handlePlayCapturedMasks:v,handleClickCaptureMasks:g}}),[p,i,o,l,f,b,v,g])},Sn=Object(Be.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},captures:{width:"100%","& > div":{marginTop:e.spacing(1)}},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)}}})),In=function(e){var t,n,o,c=Sn(),i=Ga(),l=x(),s=Object(a.useRef)(),u=Wa(xn),p=u.loopType,m=u.lapTimeInfo,d=u.simpleGame,f=u.captureMasks,b=u.handleClickGame,g=u.handleStartRandomGame,v=u.handleClickCaptureMasks,h=i.loop,O=m.color,y=Object(a.useMemo)((function(){return[{props:{key:"play/stop",onClick:b,disabled:!h.ready||!h.looping&&!d.ready,children:h.looping?"Stop":"Play"}},{props:{key:"playRandom",color:"secondary",onClick:g,disabled:!h.ready||h.looping,children:"Play Random"}},{props:{containerRef:s,key:"chooseMasks",disabled:!h.ready||h.looping,handleClick:d.zip.handleLoadPreparedMasks},Component:wn,visible:!h.looping},{props:{key:"loadMasks",variant:"contained",onChange:d.zip.handleZipInputChange,disabled:!h.ready||h.looping||d.zip.loading,children:d.loading?"Loading...":"Load Masks"},Component:Cn,visible:!h.looping},{props:{key:"captureMasks",onClick:v,disabled:!h.ready||h.looping,children:"Capture Masks",color:"default"},visible:!h.looping}]}),[h.ready,h.looping,b,d.ready,d.loading,g,d.zip.loading,v,d.zip.handleZipInputChange,d.zip.handleLoadPreparedMasks]);return r.a.createElement("div",{className:c.root},r.a.createElement("div",{className:X()(c.scrollContainer,(o={},Object(T.a)(o,c.overlay,!h.looping),Object(T.a)(o,c.rootTop,!!h.looping),Object(T.a)(o,c.rootApart,!(!(null===(t=d.scores)||void 0===t?void 0:t.length)&&!(null===(n=f.masks)||void 0===n?void 0:n.length))&&l.isFullScreen),o))},r.a.createElement("div",{className:X()(Object(T.a)({},c.optionsTop,!!h.looping)),ref:s},h.looping?r.a.createElement(hn,{offset:70,buttons:[{props:{key:"stop",onClick:b,children:"Stop"}}]}):r.a.createElement(hn,{buttons:y}),h.looping&&"play"===p&&r.a.createElement("div",{className:c.progress},r.a.createElement(it,{color:O,completed:m.percentRemaining}))),l.isFullScreen&&!h.looping&&r.a.createElement(ot,null)))},Rn=n(320),Tn=n.n(Rn),Mn=n(321),Nn=n.n(Mn),Pn=Object(j.a)((function(e){return{root:{height:"100%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"},transition:{textAlign:"center"},header:{marginBottom:e.spacing(2)}}})),Ln=(wt={},Object(T.a)(wt,Le.players.SINGLE_PLAYER,Tn.a),Object(T.a)(wt,Le.players.MULTIPLAYER,Nn.a),wt),An=function(e){var t=Pn(),n=Object(a.useCallback)((function(t){var n=t.currentTarget.name;e.setPlayerMode(n)}),[e]),o=Object(a.useMemo)((function(){return Ae.players.map((function(e){return{props:{key:e,name:e,children:e,onClick:n,Icon:Ln[e],hover:!0}}}))}),[n]);return r.a.createElement("div",{className:t.root},r.a.createElement(hn,{label:"Select Players",buttons:o,layout:"h"}))},Dn=function(e){var t=Dt(),n=Object(a.useRef)(!1),r=Object(a.useMemo)((function(){var n=t.scores.length&&!e.looping?t.scores.reduce((function(e,t){return e+t.score}),0):0,a=+n.toFixed(1)/t.scores.length;return"You finished Time Attack in ".concat(n.toFixed(1),"\n      seconds, averaging ").concat(a.toFixed(1)," seconds per pose!")}),[t,e]);Object(a.useEffect)((function(){n.current||(n.current=!0,t.zip.handleLoadPreparedMasks("custom_mask.zip"))}),[t]);var o=Object(a.useCallback)(Object(E.a)(C.a.mark((function n(){return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.looping?(e.stop(),t.reset()):e.start(t.handleTimeAttackLoop);case 1:case"end":return n.stop()}}),n)}))),[e,t]);return Object(a.useMemo)((function(){return{name:"time attack",simpleGame:t,resultsText:r,handleClickGame:o}}),[t,r,o])},Fn=Object(Be.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},screen:{textAlign:"center","& > button":{marginTop:e.spacing(2)}}}})),Un=function(e){var t,n,a=Fn(),o=Ga(),c=x(),i=Wa(Dn),l=i.simpleGame,s=i.handleClickGame,u=o.loop;return r.a.createElement("div",{className:a.root},r.a.createElement("div",{className:X()(a.scrollContainer,Object(T.a)({},a.overlay,!u.looping))},r.a.createElement("div",{className:X()(a.screen,Object(T.a)({},a.optionsTop,!!u.looping))},!u.looping&&r.a.createElement(Ht,{primaryText:"Time Attack",secondaryText:(null===(t=l.scores)||void 0===t?void 0:t.length)?"Play Again?":"Match the poses as quickly as you can.",Icon:(null===(n=l.scores)||void 0===n?void 0:n.length)?"replay":"play",iconProps:{color:"secondary",loading:!u.ready,onClick:s},middleContent:c.isFullScreen&&r.a.createElement(ot,{hideClose:!0}),helpContent:["Match each pose as quickly as possible","Your score is based on your total time, and the average time per pose.","Hop to it!"]}))))},_n=n(2155),Bn=n(2156),zn=n(2163),Yn=n(2107),Gn=n(113),Wn=n.n(Gn),Vn=n(93),Jn=n.n(Vn),qn=function(e){var t=x(),n=Object(a.useState)(Bt),r=Object(m.a)(n,2),o=r[0],c=r[1],i=Dt({setLapTimeInfo:c}),l=_t({maxMasks:5,setLapTimeInfo:c}),s=Object(a.useMemo)((function(){return i.multiplayerScores.map((function(t){return t.length&&!e.looping?t.reduce((function(e,t){return e+t.score}),0):0}))}),[i,e]),u=Object(a.useMemo)((function(){return s.map((function(e,t){return"Player ".concat(t?"Two":"One"," scored a total of ").concat(e," points")}))}),[s]),p=Object(a.useState)([[],[]]),d=Object(m.a)(p,2),f=d[0],b=d[1],g=Object(a.useState)(0),v=Object(m.a)(g,2),h=v[0],O=v[1],y=Object(a.useCallback)((function(){O((function(e){return e+1}))}),[]),j=Object(a.useCallback)((function(){e.looping?e.stop():(y(),e.start(l.handleLoop(Object(E.a)(C.a.mark((function e(){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(l.getMasks().map((function(e){var n=e.overlay;return t.dataUriToImageData(n)})));case 2:n=e.sent,0===h?b([n,[]]):1===h&&b((function(e){return[Object(lt.a)(e[0]),n]})),l.removeAllMasks();case 5:case"end":return e.stop()}}),e)}))))))}),[e,l,h,t,y]),k=Object(a.useCallback)((function(){var t=2===h?1:0,n=2===h?0:1;i.setMasks(f[t]),e.start(i.handleMultiplayerLoop(n)),y()}),[e,f,i,h,y]),w=Object(a.useCallback)((function(){O(0),i.clearScores()}),[i]),S=Object(a.useCallback)((function(){e.looping||(h<2?j():h<4?k():w())}),[e.looping,k,j,w,h]);return Object(a.useMemo)((function(){return{name:Le.mode["Multi Player"].LOCAL,simpleGame:i,handleClick:S,lapTimeInfo:o,captureMasks:l,setupProgress:h,multiplayerResultsText:u,multiplayerScoreSums:s,NUM_MASKS:5}}),[i,o,l,h,S,u,s])},Hn=Object(Be.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)},container:{textAlign:"center"},stepper:{background:"transparent",marginBottom:e.spacing(2)}}})),Xn=Object(Be.a)((function(e){return{root:{backgroundColor:"#ccc",zIndex:1,color:"#fff",width:50,height:50,display:"flex",borderRadius:"50%",justifyContent:"center",alignItems:"center"},active:{backgroundImage:"linear-gradient( 136deg, ".concat(e.palette.secondary.light," 0%, ").concat(e.palette.secondary.main," 50%, ").concat(e.palette.secondary.dark," 100%)"),boxShadow:"0 4px 10px 0 rgba(0,0,0,.25)"},completed:{backgroundImage:"linear-gradient( 136deg, ".concat(e.palette.secondary.light," 0%, ").concat(e.palette.secondary.main," 50%, ").concat(e.palette.secondary.dark," 100%)")}}}));function Kn(e){var t,n=Xn(),a=e.active,o=e.completed,c={1:r.a.createElement(Wn.a,null),2:r.a.createElement(Wn.a,null),3:r.a.createElement(Jn.a,null),4:r.a.createElement(Jn.a,null)};return r.a.createElement("div",{className:X()(n.root,(t={},Object(T.a)(t,n.active,a),Object(T.a)(t,n.completed,o),t))},c[String(e.icon)])}var $n=["Player One Capture","Player Two Capture","Player One Play","Player Two Play"],Zn=function(e){var t,n=Ga(),o=Wa(qn),c=x(),i=Object(m.a)([["One","Two"],["Two","One"]][o.setupProgress%2],2),l=i[0],s=i[1],u=o.setupProgress<2?"Player ".concat(l,", get ready to capture ").concat(o.NUM_MASKS," poses."):"Player ".concat(l,", get ready to play!"),p=o.setupProgress<2?"Player ".concat(s,", please leave the room."):"Good luck!",d=o.setupProgress>=4,f=Object(a.useMemo)((function(){return d?o.multiplayerScoreSums[0]>o.multiplayerScoreSums[1]?"Player One wins!":o.multiplayerScoreSums[0]<o.multiplayerScoreSums[1]?"Player Two wins!":"It's a tie!":""}),[o.multiplayerScoreSums,d]),b=Hn(d);return r.a.createElement("div",{className:b.root},r.a.createElement("div",{className:X()(b.scrollContainer,(t={},Object(T.a)(t,b.overlay,!n.loop.looping),Object(T.a)(t,b.rootTop,!1),Object(T.a)(t,b.rootApart,!1),t))},r.a.createElement("div",{className:X()(b.container,Object(T.a)({},b.optionsTop,!!n.loop.looping))},n.loop.looping?r.a.createElement("div",{className:b.progress},r.a.createElement(it,{color:o.lapTimeInfo.color,completed:o.lapTimeInfo.percentRemaining})):r.a.createElement(Ht,{headerContent:!d&&r.a.createElement(_n.a,{className:b.stepper,alternativeLabel:!0,activeStep:o.setupProgress,connector:r.a.createElement(Yn.a,null)},$n.map((function(e){return r.a.createElement(Bn.a,{key:e},r.a.createElement(zn.a,{StepIconComponent:Kn},e))}))),primaryText:d?f:u,middleContent:o.setupProgress>=3&&c.isFullScreen&&!n.loop.looping&&r.a.createElement(en,{isFullScreen:c.isFullScreen}),secondaryText:d?"Play again?":p,iconProps:{color:"secondary",loading:!n.loop.ready,onClick:o.handleClick},Icon:d?"replay":"play",helpContent:!d&&["In this game mode two players will compete head to head.","Each player will take turns capturing funky poses for their opponent to try and match.","The player who does the best job matching their opponent's poses will win."]}))))},Qn=n(322),ea=n.n(Qn),ta=n(323),na=n.n(ta),aa=function(e){return"CARBON_COPY_"+e},ra=function(e){return null===e||void 0===e?void 0:e.replace("CARBON_COPY_","")},oa=function(e){return e.replace(/[^a-zA-Z0-9]/g,"")},ca=function(){return na.a.internet.userName()},ia=function(e,t){window.localStorage&&t&&(console.log("Caching","CARBON_COPY_NAME"===e?"player":"opponent","name:",t),window.localStorage.setItem(e,t))},la=function(){var e=Object(a.useRef)(),t=function(){var e=Object(y.b)().enqueueSnackbar;return{info:function(t){return e(t)},warn:function(t){return e(t,{variant:"warning"})},error:function(t){return e(t,{variant:"error"})}}}(),n=x(),r=Object(a.useRef)({name:null,opponentName:null}),o=Object(a.useRef)(null),c=Object(a.useRef)(null),i=Object(a.useRef)(!1),l=Object(a.useState)(null),s=Object(m.a)(l,2),u=s[0],p=s[1],d=Object(a.useState)(null),f=Object(m.a)(d,2),b=f[0],g=f[1],v=Object(a.useState)([[],[]]),h=Object(m.a)(v,2),O=h[0],j=h[1],k=Object(a.useState)(null),w=Object(m.a)(k,2),S=w[0],I=w[1],R=Object(a.useState)(!1),T=Object(m.a)(R,2),M=T[0],N=T[1],P=Object(a.useState)(null),L=Object(m.a)(P,2),A=L[0],D=L[1],F=Object(a.useState)(!1),U=Object(m.a)(F,2),_=U[0],B=U[1],z=Xa(),Y=Object(m.a)(z,2)[1],G=Object(a.useState)(!1),W=Object(m.a)(G,2),V=W[0],J=W[1],q=Object(a.useState)(null),H=Object(m.a)(q,2),X=H[0],K=H[1],$=Object(a.useState)(!1),Z=Object(m.a)($,2),Q=Z[0],ee=Z[1],te=Object(a.useState)(""),ne=Object(m.a)(te,2),ae=ne[0],re=ne[1],oe=function(){me(oa(ca()))};Object(a.useEffect)((function(){if(!X){var e=function(){if(!window.localStorage)return console.log("No localStorage support. Private window?"),{};var e=window.localStorage.getItem("CARBON_COPY_NAME");if(!e)return console.log("No name cached in localStorage"),{};var t={name:e||null,opponentName:window.localStorage.getItem("CARBON_COPY_OPPONENT_NAME")||null};return console.log("Got localStorageCache:",t),t}(),t=oa(e.name||ca());K(t),r.current.name=e.name?oa(e.name):null,r.current.opponentName=e.opponentName?oa(e.opponentName):null,e.opponentName&&re(r.current.opponentName)}}),[X]);var ce=function(){return i.current},ie=function(){return j([[],[]])},le=function(){ie(),J(!0)},se=function(){c.current=!1,I(null),N(!1),B(!1),i.current=!1,D(null),ie(),le()},ue=function(e){I(e),B(!0),e.on("open",(function(){console.log("CONN: open"),N(!0),B(!1),c.current&&t.info("You've connected to ".concat(c.current,"!"))})),e.on("data",function(){var e=Object(E.a)(C.a.mark((function e(t){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.eventName,e.next="initialMasks"===e.t0?3:"results"===e.t0?8:"restart"===e.t0?11:13;break;case 3:return e.next=5,Promise.all(t.maskDataURIs.map(n.dataUriToImageData));case 5:return a=e.sent,j((function(e){return[i.current?e[0]:a,i.current?a:e[1]]})),e.abrupt("break",15);case 8:return r=ce()?1:0,Y((function(e){var n=Object(lt.a)(e);return n[r]=[].concat(Object(lt.a)(n[r]),[t.results]),n})),e.abrupt("break",15);case 11:return le(),e.abrupt("break",15);case 13:return console.log("Unknown event:",t),e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("disconnected",(function(e){console.log("CONN: Got disconnected",e)})),e.on("close",(function(e){console.log("CONN: close",e),t.error("Uh oh, it looks like the other player has left."),se()})),e.on("connection",(function(e){console.log("CONN connection:",e)})),e.on("error",(function(e){console.log("CONN: error",e)}))},pe=function(n){var a=new ea.a(aa(n||X));g(a),a.on("disconnected",(function(e){console.log("PEER: disconnected",e)})),a.on("close",(function(e){console.log("PEER: close",e)})),a.on("open",(function(n){console.log("PEER: open",n),e.current=!1;var a=ra(n);a!==o.current&&t.info('Listening for connections as "'.concat(a,'"')),o.current=a,ee(!1),r.current.name!==a&&ia("CARBON_COPY_NAME",a),p(n)})),a.on("connection",(function(e){console.log("PEER: connection",e);var n=ra(e.peer);D(n),t.info("".concat(n," connected with you!")),r.current.opponentName!==n&&ia("CARBON_COPY_OPPONENT_NAME",n),ue(e)})),a.on("error",(function(e){if(console.log("PEER: error",e),e.message.includes("ID")&&e.message.includes("is taken")){var n=e.message.replace("ID","").replace("is taken","").slice(1,-1),a=ra(n);t.error("The name ".concat(a," is not available.")),console.log("Error: Name already taken:",a),oe()}if(e.message.includes("Could not connect to peer")||e.message.includes("Called in wrong state")){if(e.message.includes("Could not connect to peer")){var r=e.message.replace("Could not connect to peer "),o=ra(r);t.error('Could not find user "'.concat(o,'"'))}se()}}))},me=function(t){if(t&&!(t.length<5)){e.current=!0,b&&b.destroy();var n=oa(t);K(n),pe(n)}},de=function(e){S.send(e)};return{generateRandomName:oe,cachedOpponentName:ae,init:pe,connect:function(t){if(e.current)console.log("Connecting too soon after name change. Hold your horses cowboy.");else{console.log("Attempting to connect to peer:",t);var n=b.connect(aa(t),{serialization:"json"});D(t),i.current=!0,c.current=t,ue(n)}},send:de,peer:b,connection:S,myName:X,updateName:me,disableConnect:Q,setDisableConnect:ee,peerId:ra(u),isConnecting:_,isConnected:M,isPlayerOne:ce,opponentName:A,masks:O,setMasks:j,sendResults:function(e){return de({eventName:"results",results:e})},resetGame:function(){ie(),de({eventName:"restart"})},opponentClickedReset:V,setOpponentClickedReset:J}},sa=Object(a.createContext)(),ua=function(){var e=Object(a.useContext)(sa);if(void 0===e)throw new Error("usePeerJS must be used within a PeerJSProvider");return e},pa=function(e){var t=e.children,n=la();return r.a.createElement(sa.Provider,{value:n},t)},ma=function(e,t){var n=x(),r=ua(),o=Object(a.useState)(Bt),c=Object(m.a)(o,2),i=c[0],l=c[1],s=Dt({setLapTimeInfo:l,multiplayerScoreThing:t}),u=_t({maxMasks:5,setLapTimeInfo:l});Object(a.useEffect)((function(){!r.peer&&r.myName&&r.init()}),[r]);var p=Object(a.useMemo)((function(){return s.multiplayerScores.map((function(t){return t.length&&!e.looping?t.reduce((function(e,t){return e+t.score}),0):0}))}),[s,e]),d=Object(a.useMemo)((function(){return p.map((function(e,t){var n=Number(!r.isPlayerOne())===t?"You":r.opponentName;return"".concat(n," scored a total of ").concat(e," points")}))}),[p,r]),f=Object(a.useState)(0),b=Object(m.a)(f,2),g=b[0],v=b[1],h=Object(a.useCallback)((function(){v((function(e){return e+1}))}),[]),O=Object(a.useCallback)((function(){e.looping?e.stop():(h(),e.start(u.handleLoop(Object(E.a)(C.a.mark((function e(){var t,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.getMasks().map((function(e){return e.overlay})),0!==g){e.next=9;break}return r.send({eventName:"initialMasks",maskDataURIs:t}),e.next=5,Promise.all(t.map((function(e){return n.dataUriToImageData(e)})));case 5:a=e.sent,r.setMasks((function(e){return[r.isPlayerOne()?a:e[0],r.isPlayerOne()?e[1]:a]})),e.next=10;break;case 9:console.error("Called handleCapture without setupProgress === 0");case 10:u.removeAllMasks();case 11:case"end":return e.stop()}}),e)}))))))}),[e,u,g,n,r,h]),y=Object(a.useCallback)((function(){1===g?r.isPlayerOne()?(s.setMasks(r.masks[1]),e.start(s.handleMultiplayerLoop(0,r.sendResults)),h()):h():2===g&&(r.isPlayerOne()||(s.setMasks(r.masks[0]),e.start(s.handleMultiplayerLoop(1,r.sendResults))),h())}),[e,r,s,g,h]),j=Object(a.useCallback)((function(){v(0),s.clearScores(),r.resetGame()}),[s,r]),k=Object(a.useCallback)((function(){v(0),s.clearScores(),r.setOpponentClickedReset(!1)}),[r,s]);Object(a.useEffect)((function(){r.opponentClickedReset&&k()}),[r,k]);var w=Object(a.useCallback)((function(){e.looping||(0===g?O():g<3?y():j())}),[e.looping,y,O,j,g]);return Object(a.useMemo)((function(){return{peerJs:r,name:Le.mode["Multi Player"].REMOTE,simpleGame:s,handleClick:w,lapTimeInfo:i,captureMasks:u,setupProgress:g,multiplayerResultsText:d,multiplayerScoreSums:p,incrementProgress:h,NUM_MASKS:5}}),[r,s,i,u,g,w,d,p,h])},da=n(2160),fa=Object(j.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",alignItems:"center"},button:{marginLeft:e.spacing(1),width:112},text:{flexGrow:1,maxWidth:300},start:{width:136,fontWeight:"bold",marginRight:e.spacing(1)}}})),ba=function(e){var t=fa(),n=ua(),o=Object(a.useRef)(),c=Object(a.useState)(""),i=Object(m.a)(c,2),l=i[0],s=i[1];return Object(a.useEffect)((function(){!o.current&&n.cachedOpponentName&&(o.current=!0,s(n.cachedOpponentName))}),[n]),r.a.createElement("div",{className:t.root},r.a.createElement(v.a,{className:t.start},"Opponent name is:"),r.a.createElement(da.a,{inputProps:{spellCheck:"false",style:{textAlign:"center"}},value:n.opponentName||l,className:t.text,disabled:!n.peer||!!n.connection,onChange:function(e){return s(oa(e.target.value))},placeholder:"Enter your friend's Peer ID"}),r.a.createElement(bn.a,{className:t.button,disabled:n.disableConnect||!n.peer||l.length<5||!!n.connection,variant:"outlined",onClick:function(){return n.connect(l)}},n.isConnecting?r.a.createElement(Yt.a,{color:"secondary",size:20}):"Connect"))},ga=n(326),va=n.n(ga),ha=n(324),Oa=n(325),ya=n.n(Oa),ja=Object(j.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},button:{marginLeft:e.spacing(1),width:112},text:{flexGrow:1,maxWidth:300},start:{fontWeight:"bold",marginRight:e.spacing(1),width:136}}})),ka=function(e){var t=ja(e),n=Object(a.useRef)(),o=Object(a.useState)(""),c=Object(m.a)(o,2),i=c[0],l=c[1],s=Object(a.useRef)(),u=Object(a.useRef)();Object(a.useEffect)((function(){e.myName&&e.myName!==n.current&&(n.current=e.myName,l(e.myName))}),[e.myName]);var p=function(t){return function(){var n=t||i;clearTimeout(u.current),n!==e.name&&(i.length>5?e.updateName(n):(l(e.name),e.setDisableConnect(!1)))}};return r.a.createElement("div",{className:t.root},r.a.createElement(v.a,{className:t.start},"Your name is:"),r.a.createElement(da.a,{className:t.text,ref:s,inputProps:{spellCheck:"false",style:{textAlign:"center"}},value:i,onBlur:p(),onChange:function(t){var n=t.target.value,a=oa(n);l(a),clearTimeout(u.current),e.setDisableConnect(!0),u.current=setTimeout((function(){p(a)()}),1500)}}),r.a.createElement("div",{className:t.button},r.a.createElement(K.a,{"aria-label":"random-name",color:"secondary",onClick:e.generateRandomName},r.a.createElement(ya.a,null)),r.a.createElement(ha.CopyToClipboard,{text:e.myName},r.a.createElement(K.a,{"aria-label":"copy",color:"secondary"},r.a.createElement(va.a,null)))))},Ca=Object(Be.a)((function(e){return{root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},buttons:{marginLeft:e.spacing(1)},scrollContainer:{position:"absolute",top:0,left:0,bottom:0,right:-17,overflowY:"scroll",padding:e.spacing(1),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overlay:{background:"rgba(255,255,255,0.5)"},rootTop:{justifyContent:"flex-start"},rootApart:{justifyContent:"space-between"},optionsTop:{justifyContent:"center",alignItems:"center",flexDirection:"row",width:"100%",paddingLeft:e.spacing(10),paddingRight:e.spacing(10)},progress:{position:"absolute",top:e.spacing(1),left:e.spacing(8),right:e.spacing(8)},container:{textAlign:"center"},stepper:{background:"transparent",marginBottom:e.spacing(2)},idContainer:{display:"flex",justifyContent:"center",alignItems:"center"},bold:{fontWeight:"bold",fontSize:18}}})),Ea=Object(Be.a)((function(e){return{root:{backgroundColor:"#ccc",zIndex:1,color:"#fff",width:50,height:50,display:"flex",borderRadius:"50%",justifyContent:"center",alignItems:"center"},active:{backgroundImage:"linear-gradient( 136deg, ".concat(e.palette.secondary.light," 0%, ").concat(e.palette.secondary.main," 50%, ").concat(e.palette.secondary.dark," 100%)"),boxShadow:"0 4px 10px 0 rgba(0,0,0,.25)"},completed:{backgroundImage:"linear-gradient( 136deg, ".concat(e.palette.secondary.light," 0%, ").concat(e.palette.secondary.main," 50%, ").concat(e.palette.secondary.dark," 100%)")}}}));function wa(e){var t,n=Ea(),a=e.active,o=e.completed,c={1:r.a.createElement(Wn.a,null),2:r.a.createElement(Jn.a,null),3:r.a.createElement(Jn.a,null)};return r.a.createElement("div",{className:X()(n.root,(t={},Object(T.a)(t,n.active,a),Object(T.a)(t,n.completed,o),t))},c[String(e.icon)])}var xa,Sa,Ia,Ra=function(e){var t,n=Ga(),o=x(),c=Wa(ma),i=Xa(),l=Object(m.a)(i,1)[0],s=["Capture",c.peerJs.isPlayerOne()?"You Play":"They Play",c.peerJs.isPlayerOne()?"They Play":"You Play"],u=c.peerJs.isPlayerOne()?1:0,p=5===c.peerJs.masks[u].length,d=1===c.setupProgress&&c.peerJs.isPlayerOne()||2===c.setupProgress&&!c.peerJs.isPlayerOne();Object(a.useEffect)((function(){!d&&5===l[u].length&&c.setupProgress<3&&c.incrementProgress()}),[d,l,u,c]);var f=Boolean(l[Number(c.peerJs.isPlayerOne())].length),b=r.a.createElement("div",null,r.a.createElement("p",null,"Please wait..."),r.a.createElement("br",null),r.a.createElement("p",null,"It's ",c.peerJs.opponentName,"'s turn to play."),r.a.createElement("br",null)),g=r.a.createElement("div",null,r.a.createElement("p",null,c.peerJs.opponentName," has started playing!"),r.a.createElement("br",null)),v=r.a.createElement("div",null,r.a.createElement("p",null,"It's your turn."),r.a.createElement("br",null),r.a.createElement("p",null,"Press play to start!")),h=r.a.createElement("div",null,r.a.createElement("p",null,"Waiting for ",c.peerJs.opponentName,"'s masks."),r.a.createElement("p",null,"One moment please...")),O=["Click play to capture ".concat(c.NUM_MASKS," poses."),c.peerJs.isPlayerOne()?p?v:h:f?g:b,c.peerJs.isPlayerOne()?f?g:b:p?v:h][c.setupProgress],y=c.setupProgress>=3,j=Object(a.useMemo)((function(){return y?c.multiplayerScoreSums[0]>c.multiplayerScoreSums[1]?c.peerJs.isPlayerOne()?"You won!":"You lost.":c.multiplayerScoreSums[0]<c.multiplayerScoreSums[1]?c.peerJs.isPlayerOne()?"You lost.":"You won!":"It's a tie!":""}),[c.multiplayerScoreSums,c.peerJs,y]),k=Ca(y),C=r.a.createElement(Ht,{headerContent:!y&&r.a.createElement(_n.a,{className:k.stepper,alternativeLabel:!0,activeStep:c.setupProgress,connector:r.a.createElement(Yn.a,null)},s.map((function(e){return r.a.createElement(Bn.a,{key:e},r.a.createElement(zn.a,{StepIconComponent:wa},e))}))),primaryText:y?j:O,middleContent:c.setupProgress>=2&&o.isFullScreen&&!n.loop.looping&&r.a.createElement(en,{isFullScreen:o.isFullScreen}),secondaryText:y?"Play again?":"",iconProps:{color:"secondary",loading:!n.loop.ready,onClick:c.handleClick},Icon:0===c.setupProgress||3===c.setupProgress||d&&p?y?"replay":"play":null,helpContent:!y&&["In this game mode two players will compete head to head.","Each player will take turns capturing funky poses for their opponent to try and match.","The player who does the best job matching their opponent's poses will win."]}),E=r.a.createElement(Ht,{headerContent:null,primaryText:"Connect to a friend to play remotely",middleContent:r.a.createElement("div",{className:k.idContainer},r.a.createElement(ka,{name:c.peerJs.peerId,myName:c.peerJs.myName,updateName:c.peerJs.updateName,setDisableConnect:c.peerJs.setDisableConnect,generateRandomName:c.peerJs.generateRandomName})),secondaryText:r.a.createElement(ba,null),iconProps:{color:"secondary",disabled:!0,onClick:c.handleClick}});return r.a.createElement("div",{className:k.root},r.a.createElement("div",{className:X()(k.scrollContainer,(t={},Object(T.a)(t,k.overlay,!n.loop.looping),Object(T.a)(t,k.rootTop,!1),Object(T.a)(t,k.rootApart,!1),t))},r.a.createElement("div",{className:X()(k.container,Object(T.a)({},k.optionsTop,!!n.loop.looping))},n.loop.looping?r.a.createElement("div",{className:k.progress},r.a.createElement(it,{color:c.lapTimeInfo.color,completed:c.lapTimeInfo.percentRemaining})):c.peerJs.isConnected?C:E)))},Ta=Object(T.a)({},Le.screen.PLAY,(Ia={},Object(T.a)(Ia,Le.players.SINGLE_PLAYER,(xa={},Object(T.a)(xa,Le.mode[Le.players.SINGLE_PLAYER].PRACTICE,In),Object(T.a)(xa,Le.mode[Le.players.SINGLE_PLAYER].SURVIVAL,$t),Object(T.a)(xa,Le.mode[Le.players.SINGLE_PLAYER].TIME_ATTACK,Un),xa)),Object(T.a)(Ia,Le.players.MULTIPLAYER,(Sa={},Object(T.a)(Sa,Le.mode[Le.players.MULTIPLAYER].LOCAL,Zn),Object(T.a)(Sa,Le.mode[Le.players.MULTIPLAYER].REMOTE,Ra),Sa)),Ia)),Ma=function(e){var t,n,a=e.screen.state,o=a.screen,c=a.mode,i=a.players;if(o===Le.screen.DEFAULT)return r.a.createElement(An,{setPlayerMode:e.screen.handlers.setPlayerMode});if(c===Le.mode.DEFAULT)return r.a.createElement(jn,{screen:e.screen});var l=(null===(t=Ta[o])||void 0===t||null===(n=t[i])||void 0===n?void 0:n[c])||_e;return r.a.createElement(l,null)},Na=n(327),Pa=n.n(Na)()(),La=Object(a.createContext)(),Aa=function(e){var t=e.children,n=function(){var e=x(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useState)(!1),o=Object(m.a)(r,2),c=o[0],i=o[1],l=Object(a.useState)(!1),s=Object(m.a)(l,2),u=s[0],p=s[1];Object(a.useEffect)((function(){!t.current&&e.ready&&(t.current=!0,Pa.load().then((function(){console.log("BodyPix loaded"),i(!0)})).catch(console.error))}),[e]);var d=Object(a.useCallback)(Object(E.a)(C.a.mark((function t(){var n;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c){t.next=2;break}throw new Error('Please wait for the model to load before calling "predict"');case 2:return t.next=4,Pa.predict(e.getVideoAsImageData());case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[c,e]);return Object(a.useEffect)((function(){!c||n.current||u||(n.current=!0,d().then((function(){p(!0)})))}),[d,c,u]),u?d:null}();return r.a.createElement(La.Provider,{value:n},t)},Da=function(){var e=x(),t=function(){var e=Object(a.useContext)(La);if(void 0===e)throw new Error("useBodyPix must be used within a BodyPixProvider");return e}(),n=t&&e.ready,r=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),o=Object(a.useRef)(),c=Object(a.useCallback)((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t.current=a,e.current=a,r.current=0,n.current=0,o.current=0}),[]),i=Object(a.useCallback)((function(){o.current=0}),[]),l=Object(a.useCallback)((function(a){var l=!1;t.current||(l=!0,c(a));var s=a-e.current;o.current+=s;var u=0,p=0;n.current++&&(u=1e3/s,p=r.current/n.current,r.current+=u);var m=a-t.current;return e.current=a,{first:l,timestamp:a,fps:u,avgFps:p,elapsed:m,frames:n.current,lapTime:o.current,resetLapTime:i}}),[c,i]);return Object(a.useMemo)((function(){return{update:l,reset:c}}),[l,c])}(),o=function(){var e=Object(a.useRef)(),t=Tt().handlers.speech,n=Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onBeforeStartLap,a=t.onLap,r=t.onEnd,o=t.maxLaps,c=t.setLapTimeInfo,i=t.lapDuration,l=void 0===i?3e3:i,s=t.postLapDelay,u=void 0===s?1e3:s,p=t.announceSeconds,m=void 0===p||p;a&&!e.current&&(e.current={onBeforeStartLap:n,onBeforeComplete:!1,onBeforeStarted:!1,onEndCalled:!1,onLap:a,onEnd:r,maxLaps:o,numLaps:0,lapDuration:l,postLapDelay:u,setLapTimeInfo:c,announceSeconds:m},c&&e.current.setLapTimeInfo(Bt))}),[]),r=Object(a.useCallback)(function(){var n=Object(E.a)(C.a.mark((function n(a){var r,o,c,i,l,s,u,p,m,d,f;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=a.time,o=a.webcam,c=a.predict,i=a.stop,!e.current){n.next=40;break}if(!e.current.onBeforeStartLap||e.current.onBeforeComplete){n.next=13;break}if(!e.current.onBeforeStarted){n.next=7;break}return n.abrupt("return");case 7:return e.current.onBeforeStarted=!0,n.next=10,e.current.onBeforeStartLap({time:r,webcam:o,predict:c,stop:i});case 10:return e.current.onBeforeComplete=!0,r.resetLapTime(),n.abrupt("return");case 13:if(!e.current.maxLaps||e.current.numLaps!==e.current.maxLaps){n.next=26;break}if(!e.current.onEnd){n.next=24;break}if(e.current.onEndCalled){n.next=21;break}return e.current.onEndCalled=!0,n.next=19,e.current.onEnd({time:r,webcam:o,predict:c,stop:i});case 19:return e.current=null,n.abrupt("return",i());case 21:return n.abrupt("return");case 24:return e.current=null,n.abrupt("return",i());case 26:if(l=Math.floor(r.lapTime/100)/10,s=+Math.max(e.current.lapDuration/1e3-l,0).toFixed(1),e.current.setLapTimeInfo&&(u=Math.min(Number(s)/e.current.lapDuration*1e5,100),p=100-u,m=We(u),d=s.toFixed(1),f={percent:p,percentRemaining:u,color:m,secondsRemaining:d},e.current.setLapTimeInfo(f)),s&&e.current.announceSeconds&&e.current.lastSpeech!==s&&parseInt(s,10)===Number(s)&&(e.current.lastSpeech=s,t.say("".concat(s))),!(r.lapTime>=e.current.lapDuration)||e.current.handlerCalled){n.next=39;break}return e.current.numLaps++,e.current.handlerCalled=!0,e.current.handlerResolved=!1,n.next=36,e.current.onLap({time:r,webcam:o,predict:c,stop:i,lapNum:e.current.numLaps});case 36:e.current.handlerResolved=!0,n.next=40;break;case 39:r.lapTime>=e.current.lapDuration+e.current.postLapDelay&&e.current.handlerResolved&&(r.resetLapTime(),e.current.handlerCalled=!1,e.current.handlerResolved=!1);case 40:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]),o=Object(a.useCallback)((function(){e.current=null}),[]);return Object(a.useMemo)((function(){return{clear:o,useTimer:n,handleLap:r,timerRef:e}}),[o,n,r,e])}(),c=Object(a.useRef)(),i=Object(a.useRef)(),l=Object(a.useState)(!1),s=Object(m.a)(l,2),u=s[0],p=s[1],d=Object(a.useCallback)((function(){o.clear(),r.reset(),c.current=!0,p(!0)}),[r,o]),f=Object(a.useCallback)((function(){c.current=!1,p(!1)}),[]),b=Object(a.useCallback)(function(){var n=Object(E.a)(C.a.mark((function n(a){var l,s,u;return C.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=r.update(a),s={time:l,webcam:e,predict:t,timerRef:o.timerRef,useTimer:o.useTimer,stop:f},n.next=4,i.current(s);case 4:u=n.sent,o.handleLap(s),c.current?requestAnimationFrame(b):(f(),i.current=null,e.clearCanvas(),u&&u());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[e,t,o,r,f]),g=Object(a.useCallback)(function(){var e=Object(E.a)(C.a.mark((function e(a){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}throw new Error("The loop is not ready");case 4:if(!c.current){e.next=8;break}throw new Error("The loop is already running");case 8:if(t){e.next=12;break}throw new Error("Please wait for BodyPix to load...");case 12:if(a){e.next=14;break}throw new Error("A loop handler is required when calling loop.start");case 14:return i.current=a,d(),e.abrupt("return",requestAnimationFrame(b));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[b,t,d,n]);return Object(a.useMemo)((function(){return{start:g,looping:u,ready:n,stop:f}}),[g,u,f,n])},Fa=function(e,t){switch(t.type){case Me:return Object(M.a)(Object(M.a)({},e),{},{mode:t.value});case Te:return Object(M.a)(Object(M.a)({},e),{},{screen:Le.screen.PLAY,players:t.value});case Pe:return De;case Ne:var n=Object(M.a)({},e);if(e.mode)n.mode=Le.mode.DEFAULT;else{if(e.screen===Le.screen.DEFAULT)return e;n.screen=Le.screen.DEFAULT,n.players=Le.players.DEFAULT}return n;default:throw new Error("Invalid action: ".concat(t.type))}},Ua=function(){var e=Da(),t=Object(a.useState)(null),n=Object(m.a)(t,2),r=n[0],o=n[1],c=function(){var e=Object(a.useReducer)(Fa,De),t=Object(m.a)(e,2),n=t[0],r=t[1],o=Object(a.useCallback)((function(e){if(!Ae.screen.includes(e))throw new Error("Unknown screen: ".concat(e));r({type:Re,value:e})}),[]),c=Object(a.useCallback)((function(e){if(![].concat(Object(lt.a)(Ae.mode[Le.players.SINGLE_PLAYER]),Object(lt.a)(Ae.mode[Le.players.MULTIPLAYER])).includes(e))throw new Error("Unknown gameMode: ".concat(e));r({type:Me,value:e})}),[]),i=Object(a.useCallback)((function(e){if(!Ae.players.includes(e))throw new Error("Unknown playerMode: ".concat(e));r({type:Te,value:e})}),[]),l=Object(a.useCallback)((function(){r({type:Pe})}),[]),s=Object(a.useCallback)((function(){r({type:Ne})}),[]);return[n,Object(a.useMemo)((function(){return{setScreen:o,resetState:l,setGameMode:c,reverseState:s,setPlayerMode:i}}),[o,l,c,s,i])]}(),i=Object(m.a)(c,2),l=i[0],s=i[1],u=Object(a.useState)(!1),p=Object(m.a)(u,2),d=p[0],f=p[1],b=Object(a.useRef)(),g=Tt(),v=Object(a.useState)(!1),h=Object(m.a)(v,2),O=h[0],y=h[1],j=Object(a.useCallback)((function(){y(!0)}),[]),k=Object(a.useCallback)((function(){y(!1)}),[]),C=Object(a.useCallback)((function(){f(!0)}),[]),E=Object(a.useMemo)((function(){return{onHomeScreen:l.screen===Le.screen.DEFAULT,handleBack:l.players===Le.players.MULTIPLAYER?s.resetState:s.reverseState,toggleAudio:g.handlers.toggle,audioState:g.state,openHelp:j,closeHelp:k,helpOpen:O}}),[l,s,g,k,j,O]);return Object(a.useEffect)((function(){b.current||l.screen===Le.screen.DEFAULT&&(b.current=!0)}),[l]),Object(a.useEffect)((function(){l.screen!==Le.screen.DEFAULT&&l.mode!==Le.mode.DEFAULT||!r||o(null)}),[l,r]),Object(a.useEffect)((function(){l.screen!==Le.screen.DEFAULT&&l.mode!==Le.mode.DEFAULT||!e.looping||e.stop()}),[l,e]),Object(a.useMemo)((function(){return{screen:{state:l,handlers:s},mode:r,loop:e,setMode:o,headerController:E,warning:{completed:d,handleCloseWarning:C}}}),[r,e,l,s,E,C,d])},_a=n(2157),Ba=Object(j.a)((function(e){return{title:{color:"red",fontStyle:"italic"},actions:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},dialogContent:{fontStyle:24},group:{marginTop:e.spacing(2)}}})),za=Object(a.memo)((function(e){var t=e.open,n=e.handleClose,a=Ba();return r.a.createElement(he.a,{"aria-labelledby":"warning",open:t},r.a.createElement(Oe.a,{disableTypography:!0,id:"warning",className:a.title},r.a.createElement(v.a,{variant:"h5"},"Warning!")),r.a.createElement(ye.a,{dividers:!0,className:a.dialogContent},r.a.createElement(v.a,{component:"h2",variant:"h6"},"physically demanding"),r.a.createElement(v.a,{gutterBottom:!0},"Be careful when moving. Consider consulting a medical professional before playing."),r.a.createElement("div",{className:a.group},r.a.createElement(v.a,{component:"h2",variant:"h6"},"Large Space Required"),r.a.createElement(v.a,{gutterBottom:!0},"Ensure that you have a large open playing area that will allow you to move around safely."))),r.a.createElement(_a.a,{className:a.actions},r.a.createElement(bn.a,{color:"secondary",onClick:n,variant:"contained"},"Acknowledge")))})),Ya=Object(a.createContext)(),Ga=function(){var e=Object(a.useContext)(Ya);if(!e)throw new Error("useGame must be called from inside the <Game> component.");return e},Wa=function(e){var t=Ga(),n=t.loop,r=t.setMode,o=e(n);return Object(a.useEffect)((function(){r(o)}),[o,r]),o},Va=Object(a.memo)((function(e){e.webcam;var t=Ua();return r.a.createElement(Ya.Provider,{value:t},r.a.createElement(za,{open:!t.warning.completed,handleClose:t.warning.handleCloseWarning}),r.a.createElement(xe,{controller:t.headerController}),r.a.createElement(Ue,{screenState:t.screen.state}),r.a.createElement(ve,{overlay:!t.screen.state.mode,headerController:t.headerController},r.a.createElement(Ma,{screen:t.screen})),r.a.createElement(an,{screen:t.screen}))})),Ja=function(){return r.a.createElement("div",null,"Sorry, but this game requires a webcam. Please plug in a webcam and refresh the page.")},qa=Object(j.a)((function(e){return{root:{maxWidth:1100,margin:"0 auto ".concat(e.spacing(2),"px")}}})),Ha=Object(a.createContext)(),Xa=function(){var e=Object(a.useContext)(Ha);if(!e)throw new Error("useMultiplayerScoreContext must be called from inside the <Game> component.");return e},Ka=Object(a.memo)((function(e){var t=x(),n=t.currentDeviceId,o=t.hasVideo,c=t.cameras,i=t.autoStartDeviceId,l=Object(a.useRef)();Object(a.useEffect)((function(){o&&c.length&&(n||i)&&!l.current&&(l.current=!0,t.start().catch(console.error))}),[o,c,n,i,t]);var s=qa(),u=Object(a.useState)([[],[]]);return r.a.createElement("main",{className:s.root},o?r.a.createElement(Ha.Provider,{value:u},r.a.createElement(pa,null,r.a.createElement(Va,{webcam:t}))):r.a.createElement(Ja,null))})),$a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t,["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"']).join(",")},Za=Object(h.a)({palette:{primary:{main:"#FFFFFF"},secondary:{main:"#000000"}},typography:{useNextVariants:!0,fontFamily:$a("Orbitron"),body1:{fontWeight:600,fontFamily:$a("Rajdhani"),fontSize:18}},overrides:{}});var Qa=function(){var e=Object(a.useState)(!1),t=Object(m.a)(e,2),n=t[0],o=t[1],c=Object(a.useRef)();return Object(a.useEffect)((function(){var e=setInterval((function(){window.cvReady&&(o(!0),clearInterval(e))}),200);return function(){clearInterval(e)}}),[]),Object(a.useEffect)((function(){c.current||(c.current=!0,f.a.init({selector:".background"}))})),r.a.createElement(O.a,{theme:Za},r.a.createElement(b.BrowserView,null,r.a.createElement(y.a,{maxSnack:3},r.a.createElement(I,null,r.a.createElement(Aa,null,r.a.createElement(Mt,null,r.a.createElement(At,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,null),r.a.createElement(Ka,{cvReady:n})))))))),r.a.createElement(b.MobileView,null,r.a.createElement("div",{style:{display:"flex",width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center"}},r.a.createElement(v.a,{component:"h1",variant:"h6",style:{textAlign:"center"}},"To play Carbon Copy, open this site on a laptop or desktop computer."))))};c.a.render(r.a.createElement(Qa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},327:function(e,t,n){var a=n(2104),r=["load","predict"];e.exports=function(){var e=new Worker(n.p+"d664dc4a7adbfa7297d4.worker.js",{name:"[hash].worker.js"});return a(e,r),e}},347:function(e,t,n){e.exports=n(2105)},352:function(e,t,n){},367:function(e,t){},369:function(e,t){},417:function(e,t){},419:function(e,t){},447:function(e,t){},449:function(e,t){},450:function(e,t){},456:function(e,t){},458:function(e,t){},476:function(e,t){},478:function(e,t){},490:function(e,t){},493:function(e,t){},498:function(e,t){},500:function(e,t){},523:function(e,t){},612:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=612}},[[347,1,2]]]);
//# sourceMappingURL=main.bc082a03.chunk.js.map